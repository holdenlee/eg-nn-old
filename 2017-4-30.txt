Script started on Sun 30 Apr 2017 03:33:09 PM EDT
]0;optml@valiant: ~/holdenl/mwuoptml@valiant:~/holdenl/mwu$ python mwu.py rintf "\033c"ython mwu.py 
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally
Using TensorFlow backend.
10 10 0.3
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.002  0.004  0.001  0.004  0.006  0.003  0.006  0.011  0.012  0.007]
[  7.243e-05   1.046e-05   1.283e-05   3.247e-04   1.260e-04   2.422e-04
   6.292e-05   1.143e-04   4.655e-04   3.715e-04]
[  4.444e-04   1.384e-05   4.000e-04   5.642e-04   4.930e-05   1.439e-04
   2.347e-04   4.178e-05   3.492e-05   1.680e-04]
[  1.175e-03   1.288e-04   4.319e-03   7.255e-03   8.372e-04   6.786e-03
   1.158e-02   5.415e-04   9.864e-05   3.686e-03]
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties: 
name: TITAN X (Pascal)
major: 6 minor: 1 memoryClockRate (GHz) 1.531
pciBusID 0000:02:00.0
Total memory: 11.90GiB
Free memory: 11.75GiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x56480b0
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 1 with properties: 
name: GeForce GTX 1080
major: 6 minor: 1 memoryClockRate (GHz) 1.7335
pciBusID 0000:01:00.0
Total memory: 7.92GiB
Free memory: 7.01GiB
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 0 and 1
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 1 and 0
I tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0 1 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y N 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 1:   N Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.335222 seconds. Loss: 2.299391
Step 100 took 0.007317 seconds. Loss: 2.275489
Step 200 took 0.006612 seconds. Loss: 1.852643
Step 300 took 0.006591 seconds. Loss: 0.776818
Step 400 took 0.006896 seconds. Loss: 0.426634
Step 500 took 0.006437 seconds. Loss: 0.399938
Step 600 took 0.059057 seconds. Loss: 0.426767
Doing evaluation for test
accuracy: 0.887000
Step 700 took 0.006390 seconds. Loss: 0.308328
Step 800 took 0.007034 seconds. Loss: 0.282718
Step 900 took 0.006858 seconds. Loss: 0.370399
Step 1000 took 0.006697 seconds. Loss: 0.206384
Step 1100 took 0.006396 seconds. Loss: 0.223836
Step 1200 took 0.057341 seconds. Loss: 0.160696
Doing evaluation for test
accuracy: 0.929300
Step 1300 took 0.006965 seconds. Loss: 0.147626
Step 1400 took 0.006385 seconds. Loss: 0.262440
Step 1500 took 0.007824 seconds. Loss: 0.266442
Step 1600 took 0.006711 seconds. Loss: 0.091569
Step 1700 took 0.007107 seconds. Loss: 0.192511
Step 1800 took 0.069143 seconds. Loss: 0.151543
Doing evaluation for test
accuracy: 0.953400
Step 1900 took 0.007027 seconds. Loss: 0.080059
Step 2000 took 0.007018 seconds. Loss: 0.202558
Step 2100 took 0.006523 seconds. Loss: 0.133748
Step 2200 took 0.006959 seconds. Loss: 0.160970
Step 2300 took 0.006853 seconds. Loss: 0.128093
Step 2400 took 0.056452 seconds. Loss: 0.182621
Doing evaluation for test
accuracy: 0.963700
Step 2500 took 0.006493 seconds. Loss: 0.093905
Step 2600 took 0.006993 seconds. Loss: 0.170698
Step 2700 took 0.006591 seconds. Loss: 0.111376
Step 2800 took 0.006558 seconds. Loss: 0.126900
Step 2900 took 0.006612 seconds. Loss: 0.112280
Doing evaluation for test
accuracy: 0.969300
10 10 0.1
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.004  0.001  0.004  0.001  0.014  0.006  0.002  0.002  0.049  0.004]
[  7.070e-04   1.270e-04   1.863e-04   4.333e-04   6.184e-04   2.262e-04
   3.514e-04   5.194e-05   5.167e-04   1.731e-04]
[  5.258e-04   1.103e-04   8.135e-05   9.245e-05   1.547e-04   1.661e-05
   2.153e-04   3.022e-04   6.800e-05   1.676e-05]
[ 0.003  0.     0.002  0.001  0.005  0.007  0.003  0.003  0.005  0.008]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.032998 seconds. Loss: 2.299391
Step 100 took 0.006434 seconds. Loss: 2.297051
Step 200 took 0.007198 seconds. Loss: 2.291275
Step 300 took 0.006758 seconds. Loss: 2.287089
Step 400 took 0.006694 seconds. Loss: 2.239825
Step 500 took 0.007023 seconds. Loss: 2.158129
Step 600 took 0.065648 seconds. Loss: 1.740925
Doing evaluation for test
accuracy: 0.569600
Step 700 took 0.007073 seconds. Loss: 1.030254
Step 800 took 0.006461 seconds. Loss: 0.688683
Step 900 took 0.006656 seconds. Loss: 0.463601
Step 1000 took 0.006836 seconds. Loss: 0.420736
Step 1100 took 0.006656 seconds. Loss: 0.394785
Step 1200 took 0.062689 seconds. Loss: 0.420694
Doing evaluation for test
accuracy: 0.886300
Step 1300 took 0.006518 seconds. Loss: 0.395296
Step 1400 took 0.006790 seconds. Loss: 0.474988
Step 1500 took 0.006750 seconds. Loss: 0.296308
Step 1600 took 0.006748 seconds. Loss: 0.354535
Step 1700 took 0.006642 seconds. Loss: 0.437355
Step 1800 took 0.061688 seconds. Loss: 0.243190
Doing evaluation for test
accuracy: 0.908900
Step 1900 took 0.007683 seconds. Loss: 0.195605
Step 2000 took 0.006869 seconds. Loss: 0.272978
Step 2100 took 0.006781 seconds. Loss: 0.254622
Step 2200 took 0.012831 seconds. Loss: 0.247795
Step 2300 took 0.014390 seconds. Loss: 0.224591
Step 2400 took 0.059916 seconds. Loss: 0.216463
Doing evaluation for test
accuracy: 0.928700
Step 2500 took 0.013732 seconds. Loss: 0.359857
Step 2600 took 0.006624 seconds. Loss: 0.401650
Step 2700 took 0.006818 seconds. Loss: 0.281060
Step 2800 took 0.007207 seconds. Loss: 0.274131
Step 2900 took 0.007034 seconds. Loss: 0.202515
Doing evaluation for test
accuracy: 0.940300
10 10 0.03
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.003  0.021  0.002  0.003  0.009  0.002  0.004  0.013  0.01   0.003]
[  8.717e-06   1.689e-04   4.453e-04   4.521e-04   7.027e-05   4.307e-04
   1.693e-04   2.919e-05   2.852e-04   3.016e-04]
[  5.139e-04   3.958e-05   6.015e-05   9.144e-07   1.097e-04   1.289e-04
   7.798e-05   2.222e-04   1.182e-04   1.552e-04]
[ 0.004  0.01   0.     0.001  0.003  0.002  0.001  0.006  0.011  0.006]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.030915 seconds. Loss: 2.299391
Step 100 took 0.006512 seconds. Loss: 2.302171
Step 200 took 0.006930 seconds. Loss: 2.298345
Step 300 took 0.006646 seconds. Loss: 2.302517
Step 400 took 0.006586 seconds. Loss: 2.291655
Step 500 took 0.006938 seconds. Loss: 2.294243
Step 600 took 0.066577 seconds. Loss: 2.290839
Doing evaluation for test
accuracy: 0.113500
Step 700 took 0.006568 seconds. Loss: 2.298439
Step 800 took 0.006691 seconds. Loss: 2.287287
Step 900 took 0.006951 seconds. Loss: 2.291689
Step 1000 took 0.007185 seconds. Loss: 2.288499
Step 1100 took 0.006587 seconds. Loss: 2.272137
Step 1200 took 0.073873 seconds. Loss: 2.267323
Doing evaluation for test
accuracy: 0.174500
Step 1300 took 0.006754 seconds. Loss: 2.252662
Step 1400 took 0.007219 seconds. Loss: 2.241992
Step 1500 took 0.007032 seconds. Loss: 2.233278
Step 1600 took 0.006613 seconds. Loss: 2.191563
Step 1700 took 0.006864 seconds. Loss: 2.123937
Step 1800 took 0.074407 seconds. Loss: 2.100817
Doing evaluation for test
accuracy: 0.445700
Step 1900 took 0.006719 seconds. Loss: 1.911254
Step 2000 took 0.007617 seconds. Loss: 1.860081
Step 2100 took 0.006708 seconds. Loss: 1.516347
Step 2200 took 0.006895 seconds. Loss: 1.315840
Step 2300 took 0.006605 seconds. Loss: 1.092084
Step 2400 took 0.055725 seconds. Loss: 0.925458
Doing evaluation for test
accuracy: 0.778300
Step 2500 took 0.006634 seconds. Loss: 0.728705
Step 2600 took 0.006887 seconds. Loss: 0.800272
Step 2700 took 0.006640 seconds. Loss: 0.576263
Step 2800 took 0.006637 seconds. Loss: 0.578126
Step 2900 took 0.008098 seconds. Loss: 0.569616
Doing evaluation for test
accuracy: 0.849000
10 10 0.01
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.005  0.006  0.006  0.001  0.01   0.005  0.018  0.013  0.02   0.014]
[  4.118e-05   3.089e-04   5.035e-05   6.876e-05   3.034e-04   1.932e-05
   3.465e-04   3.590e-05   2.124e-05   7.399e-05]
[  4.034e-05   3.805e-05   1.569e-04   1.215e-04   1.490e-04   5.067e-04
   4.318e-04   1.978e-05   1.675e-04   1.787e-04]
[ 0.008  0.009  0.001  0.001  0.     0.003  0.002  0.     0.001  0.002]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.031255 seconds. Loss: 2.299391
Step 100 took 0.006691 seconds. Loss: 2.303772
Step 200 took 0.006803 seconds. Loss: 2.300153
Step 300 took 0.007251 seconds. Loss: 2.304827
Step 400 took 0.007737 seconds. Loss: 2.297379
Step 500 took 0.006741 seconds. Loss: 2.299807
Step 600 took 0.061016 seconds. Loss: 2.297281
Doing evaluation for test
accuracy: 0.113500
Step 700 took 0.007248 seconds. Loss: 2.298399
Step 800 took 0.006729 seconds. Loss: 2.298328
Step 900 took 0.007031 seconds. Loss: 2.294548
Step 1000 took 0.006929 seconds. Loss: 2.293601
Step 1100 took 0.006769 seconds. Loss: 2.296200
Step 1200 took 0.065421 seconds. Loss: 2.293978
Doing evaluation for test
accuracy: 0.113500
Step 1300 took 0.006833 seconds. Loss: 2.295810
Step 1400 took 0.006928 seconds. Loss: 2.288332
Step 1500 took 0.006571 seconds. Loss: 2.297914
Step 1600 took 0.006771 seconds. Loss: 2.293209
Step 1700 took 0.006696 seconds. Loss: 2.289182
Step 1800 took 0.069850 seconds. Loss: 2.288545
Doing evaluation for test
accuracy: 0.113500
Step 1900 took 0.006506 seconds. Loss: 2.291087
Step 2000 took 0.007176 seconds. Loss: 2.288404
Step 2100 took 0.006608 seconds. Loss: 2.284366
Step 2200 took 0.006657 seconds. Loss: 2.291538
Step 2300 took 0.007195 seconds. Loss: 2.276090
Step 2400 took 0.055429 seconds. Loss: 2.282921
Doing evaluation for test
accuracy: 0.113500
Step 2500 took 0.006691 seconds. Loss: 2.284164
Step 2600 took 0.007085 seconds. Loss: 2.283322
Step 2700 took 0.008544 seconds. Loss: 2.279185
Step 2800 took 0.007073 seconds. Loss: 2.289133
Step 2900 took 0.006629 seconds. Loss: 2.285437
Doing evaluation for test
accuracy: 0.113500
10 20 0.3
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.003  0.001  0.02   0.024  0.019  0.009  0.001  0.008  0.006  0.002]
[  1.403e-04   2.165e-04   1.764e-04   1.255e-04   1.154e-04   2.418e-04
   6.251e-04   3.299e-05   2.493e-05   1.765e-04]
[  5.886e-05   6.737e-04   9.707e-05   1.551e-05   6.558e-05   2.358e-04
   1.077e-04   3.451e-05   1.957e-04   1.110e-04]
[ 0.001  0.012  0.003  0.002  0.002  0.007  0.003  0.008  0.012  0.001]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.036204 seconds. Loss: 2.297233
Step 100 took 0.007092 seconds. Loss: 1.688919
Step 200 took 0.006749 seconds. Loss: 0.681447
Step 300 took 0.006790 seconds. Loss: 0.489495
Step 400 took 0.007031 seconds. Loss: 0.370452
Step 500 took 0.007081 seconds. Loss: 0.255501
Step 600 took 0.055914 seconds. Loss: 0.279627
Doing evaluation for test
accuracy: 0.925100
Step 700 took 0.007188 seconds. Loss: 0.222019
Step 800 took 0.006943 seconds. Loss: 0.226261
Step 900 took 0.006749 seconds. Loss: 0.247350
Step 1000 took 0.006960 seconds. Loss: 0.203189
Step 1100 took 0.011444 seconds. Loss: 0.123866
Step 1200 took 0.089804 seconds. Loss: 0.281870
Doing evaluation for test
accuracy: 0.952700
Step 1300 took 0.007442 seconds. Loss: 0.241217
Step 1400 took 0.007074 seconds. Loss: 0.102610
Step 1500 took 0.006939 seconds. Loss: 0.120751
Step 1600 took 0.007633 seconds. Loss: 0.146496
Step 1700 took 0.007045 seconds. Loss: 0.064869
Step 1800 took 0.083916 seconds. Loss: 0.120075
Doing evaluation for test
accuracy: 0.967300
Step 1900 took 0.007140 seconds. Loss: 0.081990
Step 2000 took 0.006710 seconds. Loss: 0.116082
Step 2100 took 0.006794 seconds. Loss: 0.064567
Step 2200 took 0.006778 seconds. Loss: 0.079588
Step 2300 took 0.007020 seconds. Loss: 0.037835
Step 2400 took 0.074232 seconds. Loss: 0.050837
Doing evaluation for test
accuracy: 0.974300
Step 2500 took 0.007190 seconds. Loss: 0.037652
Step 2600 took 0.006977 seconds. Loss: 0.054857
Step 2700 took 0.007527 seconds. Loss: 0.096186
Step 2800 took 0.006832 seconds. Loss: 0.046242
Step 2900 took 0.006965 seconds. Loss: 0.069673
Doing evaluation for test
accuracy: 0.973200
10 20 0.1
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[  1.466e-03   8.235e-03   2.647e-03   7.004e-03   8.612e-05   1.583e-03
   2.866e-03   1.016e-02   6.675e-03   5.294e-03]
[  2.820e-04   1.314e-04   4.676e-05   1.677e-04   1.486e-04   2.770e-04
   2.214e-04   1.207e-04   9.775e-06   3.450e-04]
[  1.079e-05   5.179e-05   1.634e-05   3.207e-04   1.602e-04   9.604e-05
   1.155e-06   1.430e-04   1.515e-04   1.986e-05]
[ 0.005  0.002  0.003  0.002  0.001  0.011  0.     0.001  0.     0.003]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.040465 seconds. Loss: 2.297233
Step 100 took 0.006846 seconds. Loss: 2.275584
Step 200 took 0.007202 seconds. Loss: 2.215440
Step 300 took 0.006741 seconds. Loss: 1.741326
Step 400 took 0.006828 seconds. Loss: 0.638816
Step 500 took 0.007250 seconds. Loss: 0.545696
Step 600 took 0.084634 seconds. Loss: 0.570976
Doing evaluation for test
accuracy: 0.866000
Step 700 took 0.006785 seconds. Loss: 0.459237
Step 800 took 0.006792 seconds. Loss: 0.253800
Step 900 took 0.006841 seconds. Loss: 0.290484
Step 1000 took 0.006834 seconds. Loss: 0.277857
Step 1100 took 0.006730 seconds. Loss: 0.346658
Step 1200 took 0.072698 seconds. Loss: 0.283468
Doing evaluation for test
accuracy: 0.917400
Step 1300 took 0.006948 seconds. Loss: 0.255265
Step 1400 took 0.006963 seconds. Loss: 0.222498
Step 1500 took 0.007217 seconds. Loss: 0.366222
Step 1600 took 0.007505 seconds. Loss: 0.294537
Step 1700 took 0.007010 seconds. Loss: 0.256517
Step 1800 took 0.059059 seconds. Loss: 0.108351
Doing evaluation for test
accuracy: 0.939200
Step 1900 took 0.006810 seconds. Loss: 0.223760
Step 2000 took 0.007410 seconds. Loss: 0.227630
Step 2100 took 0.006624 seconds. Loss: 0.248152
Step 2200 took 0.007236 seconds. Loss: 0.176746
Step 2300 took 0.007212 seconds. Loss: 0.224677
Step 2400 took 0.058677 seconds. Loss: 0.163235
Doing evaluation for test
accuracy: 0.950100
Step 2500 took 0.007009 seconds. Loss: 0.162370
Step 2600 took 0.007093 seconds. Loss: 0.243226
Step 2700 took 0.007027 seconds. Loss: 0.113761
Step 2800 took 0.006731 seconds. Loss: 0.160875
Step 2900 took 0.007068 seconds. Loss: 0.170549
Doing evaluation for test
accuracy: 0.957300
10 20 0.03
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.012  0.001  0.02   0.006  0.01   0.006  0.005  0.002  0.018  0.008]
[  2.490e-04   4.616e-05   3.821e-04   1.329e-04   7.773e-05   9.845e-07
   1.496e-04   1.655e-05   1.891e-04   2.734e-04]
[  1.716e-05   1.146e-04   6.966e-05   3.367e-04   1.071e-04   2.546e-04
   1.197e-04   1.181e-05   6.944e-05   7.980e-05]
[ 0.001  0.01   0.003  0.006  0.001  0.002  0.014  0.001  0.019  0.   ]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.041322 seconds. Loss: 2.297233
Step 100 took 0.007287 seconds. Loss: 2.296670
Step 200 took 0.007018 seconds. Loss: 2.291549
Step 300 took 0.007100 seconds. Loss: 2.291039
Step 400 took 0.006895 seconds. Loss: 2.264537
Step 500 took 0.009162 seconds. Loss: 2.258092
Step 600 took 0.058007 seconds. Loss: 2.232081
Doing evaluation for test
accuracy: 0.341600
Step 700 took 0.006888 seconds. Loss: 2.177831
Step 800 took 0.007727 seconds. Loss: 2.118296
Step 900 took 0.006661 seconds. Loss: 1.839306
Step 1000 took 0.006864 seconds. Loss: 1.594609
Step 1100 took 0.007456 seconds. Loss: 1.269591
Step 1200 took 0.074993 seconds. Loss: 0.802752
Doing evaluation for test
accuracy: 0.773400
Step 1300 took 0.006757 seconds. Loss: 0.744866
Step 1400 took 0.006997 seconds. Loss: 0.715656
Step 1500 took 0.007135 seconds. Loss: 0.539711
Step 1600 took 0.007686 seconds. Loss: 0.547408
Step 1700 took 0.006891 seconds. Loss: 0.427862
Step 1800 took 0.067836 seconds. Loss: 0.463018
Doing evaluation for test
accuracy: 0.868600
Step 1900 took 0.007131 seconds. Loss: 0.663439
Step 2000 took 0.006828 seconds. Loss: 0.436710
Step 2100 took 0.006703 seconds. Loss: 0.505294
Step 2200 took 0.006790 seconds. Loss: 0.373098
Step 2300 took 0.006811 seconds. Loss: 0.371770
Step 2400 took 0.066195 seconds. Loss: 0.333756
Doing evaluation for test
accuracy: 0.894100
Step 2500 took 0.007063 seconds. Loss: 0.376772
Step 2600 took 0.007318 seconds. Loss: 0.285377
Step 2700 took 0.007753 seconds. Loss: 0.341172
Step 2800 took 0.006984 seconds. Loss: 0.424782
Step 2900 took 0.006816 seconds. Loss: 0.320031
Doing evaluation for test
accuracy: 0.912400
10 20 0.01
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.009  0.003  0.001  0.003  0.     0.004  0.006  0.002  0.009  0.006]
[  3.358e-05   6.288e-05   4.298e-04   3.929e-04   5.974e-04   7.691e-07
   2.482e-04   2.407e-04   2.834e-05   6.732e-05]
[  2.634e-05   4.692e-05   1.248e-04   1.445e-05   7.686e-04   3.121e-05
   3.227e-04   7.555e-05   3.169e-05   1.158e-05]
[ 0.014  0.003  0.002  0.01   0.     0.005  0.002  0.001  0.001  0.003]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.052412 seconds. Loss: 2.297233
Step 100 took 0.006662 seconds. Loss: 2.303329
Step 200 took 0.007599 seconds. Loss: 2.297193
Step 300 took 0.007833 seconds. Loss: 2.303567
Step 400 took 0.007190 seconds. Loss: 2.289201
Step 500 took 0.006706 seconds. Loss: 2.292677
Step 600 took 0.079176 seconds. Loss: 2.297215
Doing evaluation for test
accuracy: 0.113500
Step 700 took 0.006762 seconds. Loss: 2.293215
Step 800 took 0.007744 seconds. Loss: 2.283861
Step 900 took 0.006718 seconds. Loss: 2.287296
Step 1000 took 0.006988 seconds. Loss: 2.280818
Step 1100 took 0.006936 seconds. Loss: 2.274629
Step 1200 took 0.070089 seconds. Loss: 2.274973
Doing evaluation for test
accuracy: 0.117900
Step 1300 took 0.007638 seconds. Loss: 2.264245
Step 1400 took 0.007367 seconds. Loss: 2.264791
Step 1500 took 0.007577 seconds. Loss: 2.255612
Step 1600 took 0.006993 seconds. Loss: 2.241272
Step 1700 took 0.006607 seconds. Loss: 2.242800
Step 1800 took 0.056614 seconds. Loss: 2.215680
Doing evaluation for test
accuracy: 0.298400
Step 1900 took 0.006965 seconds. Loss: 2.223204
Step 2000 took 0.007118 seconds. Loss: 2.204179
Step 2100 took 0.006945 seconds. Loss: 2.169578
Step 2200 took 0.006626 seconds. Loss: 2.139604
Step 2300 took 0.007396 seconds. Loss: 2.070856
Step 2400 took 0.073200 seconds. Loss: 2.090115
Doing evaluation for test
accuracy: 0.444300
Step 2500 took 0.006991 seconds. Loss: 2.033996
Step 2600 took 0.007675 seconds. Loss: 1.978783
Step 2700 took 0.007322 seconds. Loss: 1.831745
Step 2800 took 0.007526 seconds. Loss: 1.713721
Step 2900 took 0.007234 seconds. Loss: 1.740448
Doing evaluation for test
accuracy: 0.655100
10 50 0.3
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.005  0.016  0.001  0.01   0.011  0.006  0.005  0.01   0.     0.009]
[  7.457e-07   5.291e-04   2.541e-04   3.304e-07   1.307e-04   2.309e-05
   3.233e-04   1.913e-04   4.634e-05   2.535e-04]
[  2.589e-04   6.771e-05   2.267e-04   1.810e-04   1.477e-04   5.248e-05
   3.293e-05   1.240e-04   5.128e-05   1.554e-04]
[ 0.004  0.002  0.002  0.004  0.014  0.001  0.006  0.     0.     0.001]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.044062 seconds. Loss: 2.296828
Step 100 took 0.006730 seconds. Loss: 0.778049
Step 200 took 0.007294 seconds. Loss: 0.451706
Step 300 took 0.007264 seconds. Loss: 0.308184
Step 400 took 0.006812 seconds. Loss: 0.343547
Step 500 took 0.006790 seconds. Loss: 0.129552
Step 600 took 0.070982 seconds. Loss: 0.164299
Doing evaluation for test
accuracy: 0.956800
Step 700 took 0.006957 seconds. Loss: 0.120617
Step 800 took 0.007162 seconds. Loss: 0.155574
Step 900 took 0.006885 seconds. Loss: 0.080528
Step 1000 took 0.007140 seconds. Loss: 0.155066
Step 1100 took 0.007116 seconds. Loss: 0.110550
Step 1200 took 0.075296 seconds. Loss: 0.072478
Doing evaluation for test
accuracy: 0.971000
Step 1300 took 0.006810 seconds. Loss: 0.050567
Step 1400 took 0.006824 seconds. Loss: 0.070976
Step 1500 took 0.007353 seconds. Loss: 0.160695
Step 1600 took 0.007680 seconds. Loss: 0.086955
Step 1700 took 0.007454 seconds. Loss: 0.116303
Step 1800 took 0.054973 seconds. Loss: 0.054031
Doing evaluation for test
accuracy: 0.977900
Step 1900 took 0.006578 seconds. Loss: 0.060143
Step 2000 took 0.007231 seconds. Loss: 0.110216
Step 2100 took 0.007303 seconds. Loss: 0.028042
Step 2200 took 0.007105 seconds. Loss: 0.070848
Step 2300 took 0.006961 seconds. Loss: 0.038813
Step 2400 took 0.056387 seconds. Loss: 0.015512
Doing evaluation for test
accuracy: 0.980900
Step 2500 took 0.007885 seconds. Loss: 0.095108
Step 2600 took 0.007816 seconds. Loss: 0.023351
Step 2700 took 0.007391 seconds. Loss: 0.050837
Step 2800 took 0.007068 seconds. Loss: 0.034696
Step 2900 took 0.007055 seconds. Loss: 0.065407
Doing evaluation for test
accuracy: 0.983000
10 50 0.1
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.     0.015  0.048  0.026  0.033  0.007  0.002  0.008  0.001  0.014]
[  3.295e-04   6.188e-05   1.342e-04   4.374e-05   4.107e-04   1.652e-04
   2.460e-04   1.396e-04   5.305e-04   4.692e-04]
[  1.884e-04   1.656e-05   1.395e-06   1.575e-04   2.271e-04   1.506e-06
   1.231e-04   5.986e-05   4.609e-05   5.466e-04]
[ 0.005  0.002  0.018  0.005  0.004  0.013  0.003  0.006  0.005  0.006]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.053204 seconds. Loss: 2.296828
Step 100 took 0.006808 seconds. Loss: 1.843658
Step 200 took 0.006613 seconds. Loss: 0.735823
Step 300 took 0.007133 seconds. Loss: 0.555443
Step 400 took 0.007110 seconds. Loss: 0.462449
Step 500 took 0.008039 seconds. Loss: 0.326409
Step 600 took 0.074565 seconds. Loss: 0.447336
Doing evaluation for test
accuracy: 0.915600
Step 700 took 0.007102 seconds. Loss: 0.308078
Step 800 took 0.007030 seconds. Loss: 0.200648
Step 900 took 0.007141 seconds. Loss: 0.162238
Step 1000 took 0.007015 seconds. Loss: 0.401789
Step 1100 took 0.007308 seconds. Loss: 0.187725
Step 1200 took 0.058695 seconds. Loss: 0.189037
Doing evaluation for test
accuracy: 0.946200
Step 1300 took 0.006812 seconds. Loss: 0.210986
Step 1400 took 0.007076 seconds. Loss: 0.197766
Step 1500 took 0.007314 seconds. Loss: 0.103003
Step 1600 took 0.007195 seconds. Loss: 0.229656
Step 1700 took 0.006934 seconds. Loss: 0.176897
Step 1800 took 0.056337 seconds. Loss: 0.111838
Doing evaluation for test
accuracy: 0.959300
Step 1900 took 0.006655 seconds. Loss: 0.192736
Step 2000 took 0.008452 seconds. Loss: 0.090302
Step 2100 took 0.007184 seconds. Loss: 0.098748
Step 2200 took 0.007693 seconds. Loss: 0.084627
Step 2300 took 0.007082 seconds. Loss: 0.102178
Step 2400 took 0.063547 seconds. Loss: 0.192946
Doing evaluation for test
accuracy: 0.967500
Step 2500 took 0.007304 seconds. Loss: 0.074020
Step 2600 took 0.007272 seconds. Loss: 0.095243
Step 2700 took 0.006868 seconds. Loss: 0.071336
Step 2800 took 0.006855 seconds. Loss: 0.157874
Step 2900 took 0.007010 seconds. Loss: 0.024987
Doing evaluation for test
accuracy: 0.972500
10 50 0.03
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.005  0.003  0.008  0.005  0.021  0.009  0.013  0.004  0.001  0.006]
[  1.196e-04   4.270e-04   2.723e-04   7.640e-04   2.010e-05   1.411e-04
   3.584e-04   4.591e-04   6.879e-04   1.656e-04]
[  4.647e-06   3.164e-05   1.362e-04   1.740e-04   3.080e-04   2.259e-04
   6.122e-05   3.929e-05   1.236e-04   3.792e-05]
[ 0.002  0.005  0.005  0.01   0.001  0.003  0.001  0.002  0.     0.011]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.081735 seconds. Loss: 2.296828
Step 100 took 0.007005 seconds. Loss: 2.260176
Step 200 took 0.006717 seconds. Loss: 2.211145
Step 300 took 0.007064 seconds. Loss: 2.040891
Step 400 took 0.007574 seconds. Loss: 1.328258
Step 500 took 0.007187 seconds. Loss: 0.852559
Step 600 took 0.064388 seconds. Loss: 0.632458
Doing evaluation for test
accuracy: 0.830400
Step 700 took 0.007127 seconds. Loss: 0.595353
Step 800 took 0.006781 seconds. Loss: 0.563044
Step 900 took 0.006796 seconds. Loss: 0.385123
Step 1000 took 0.006869 seconds. Loss: 0.463152
Step 1100 took 0.006888 seconds. Loss: 0.341497
Step 1200 took 0.063767 seconds. Loss: 0.358324
Doing evaluation for test
accuracy: 0.900100
Step 1300 took 0.006924 seconds. Loss: 0.285913
Step 1400 took 0.007257 seconds. Loss: 0.309058
Step 1500 took 0.007023 seconds. Loss: 0.404987
Step 1600 took 0.007069 seconds. Loss: 0.384879
Step 1700 took 0.007852 seconds. Loss: 0.313809
Step 1800 took 0.074591 seconds. Loss: 0.225615
Doing evaluation for test
accuracy: 0.914300
Step 1900 took 0.007609 seconds. Loss: 0.392660
Step 2000 took 0.006689 seconds. Loss: 0.436729
Step 2100 took 0.006816 seconds. Loss: 0.263722
Step 2200 took 0.007278 seconds. Loss: 0.331308
Step 2300 took 0.007248 seconds. Loss: 0.192979
Step 2400 took 0.074888 seconds. Loss: 0.316810
Doing evaluation for test
accuracy: 0.930900
Step 2500 took 0.007533 seconds. Loss: 0.265262
Step 2600 took 0.007235 seconds. Loss: 0.190495
Step 2700 took 0.007402 seconds. Loss: 0.138673
Step 2800 took 0.008227 seconds. Loss: 0.249080
Step 2900 took 0.007121 seconds. Loss: 0.250327
Doing evaluation for test
accuracy: 0.938500
10 50 0.01
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[  3.446e-03   9.940e-04   9.087e-03   1.217e-02   4.774e-03   1.456e-02
   3.621e-03   2.343e-06   4.232e-03   9.016e-03]
[  5.832e-04   1.006e-04   3.131e-04   5.313e-05   9.888e-05   8.222e-05
   9.811e-05   9.053e-05   7.709e-05   4.690e-04]
[  2.002e-04   9.160e-05   2.295e-04   1.081e-05   3.896e-04   4.999e-05
   1.019e-04   1.001e-04   1.611e-04   9.743e-05]
[ 0.006  0.005  0.002  0.002  0.002  0.006  0.005  0.011  0.002  0.015]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.080210 seconds. Loss: 2.296828
Step 100 took 0.006700 seconds. Loss: 2.289196
Step 200 took 0.007098 seconds. Loss: 2.283693
Step 300 took 0.006839 seconds. Loss: 2.276942
Step 400 took 0.006683 seconds. Loss: 2.237988
Step 500 took 0.006724 seconds. Loss: 2.228057
Step 600 took 0.065712 seconds. Loss: 2.191356
Doing evaluation for test
accuracy: 0.502900
Step 700 took 0.007057 seconds. Loss: 2.129548
Step 800 took 0.007059 seconds. Loss: 2.090000
Step 900 took 0.006987 seconds. Loss: 1.994802
Step 1000 took 0.007096 seconds. Loss: 1.769198
Step 1100 took 0.007457 seconds. Loss: 1.669643
Step 1200 took 0.074917 seconds. Loss: 1.359403
Doing evaluation for test
accuracy: 0.700300
Step 1300 took 0.007080 seconds. Loss: 1.159103
Step 1400 took 0.006795 seconds. Loss: 0.923277
Step 1500 took 0.007586 seconds. Loss: 0.808198
Step 1600 took 0.006948 seconds. Loss: 0.658094
Step 1700 took 0.007108 seconds. Loss: 0.667217
Step 1800 took 0.055247 seconds. Loss: 0.652823
Doing evaluation for test
accuracy: 0.838000
Step 1900 took 0.006859 seconds. Loss: 0.555145
Step 2000 took 0.007159 seconds. Loss: 0.528518
Step 2100 took 0.007032 seconds. Loss: 0.388905
Step 2200 took 0.007357 seconds. Loss: 0.488752
Step 2300 took 0.012130 seconds. Loss: 0.441862
Step 2400 took 0.074391 seconds. Loss: 0.286702
Doing evaluation for test
accuracy: 0.872700
Step 2500 took 0.006767 seconds. Loss: 0.427196
Step 2600 took 0.007571 seconds. Loss: 0.454105
Step 2700 took 0.007049 seconds. Loss: 0.353446
Step 2800 took 0.007328 seconds. Loss: 0.219804
Step 2900 took 0.007260 seconds. Loss: 0.503915
Doing evaluation for test
accuracy: 0.892100
20 10 0.3
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.004  0.002  0.002  0.03   0.     0.003  0.008  0.007  0.011  0.016]
[  1.679e-04   9.968e-05   2.337e-04   9.517e-05   1.441e-04   2.830e-04
   4.408e-04   2.529e-04   3.327e-04   1.344e-04]
[  1.976e-04   1.563e-04   2.039e-04   7.204e-06   1.139e-05   1.849e-04
   2.985e-04   1.713e-04   2.485e-04   3.089e-05]
[ 0.002  0.003  0.003  0.003  0.009  0.001  0.001  0.001  0.003  0.005]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.053264 seconds. Loss: 2.301866
Step 100 took 0.007072 seconds. Loss: 0.385078
Step 200 took 0.007399 seconds. Loss: 0.352535
Step 300 took 0.007337 seconds. Loss: 0.304790
Step 400 took 0.007073 seconds. Loss: 0.149568
Step 500 took 0.007112 seconds. Loss: 0.101115
Step 600 took 0.074718 seconds. Loss: 0.104547
Doing evaluation for test
accuracy: 0.960000
Step 700 took 0.007007 seconds. Loss: 0.188700
Step 800 took 0.007225 seconds. Loss: 0.151366
Step 900 took 0.006925 seconds. Loss: 0.110956
Step 1000 took 0.007307 seconds. Loss: 0.142729
Step 1100 took 0.007302 seconds. Loss: 0.155172
Step 1200 took 0.078722 seconds. Loss: 0.086998
Doing evaluation for test
accuracy: 0.975800
Step 1300 took 0.007638 seconds. Loss: 0.054129
Step 1400 took 0.007473 seconds. Loss: 0.050459
Step 1500 took 0.007037 seconds. Loss: 0.053525
Step 1600 took 0.007067 seconds. Loss: 0.037012
Step 1700 took 0.007710 seconds. Loss: 0.014334
Step 1800 took 0.066960 seconds. Loss: 0.025800
Doing evaluation for test
accuracy: 0.983100
Step 1900 took 0.007168 seconds. Loss: 0.031181
Step 2000 took 0.006850 seconds. Loss: 0.074924
Step 2100 took 0.007274 seconds. Loss: 0.075123
Step 2200 took 0.007298 seconds. Loss: 0.038205
Step 2300 took 0.007181 seconds. Loss: 0.120703
Step 2400 took 0.054424 seconds. Loss: 0.071057
Doing evaluation for test
accuracy: 0.982500
Step 2500 took 0.006945 seconds. Loss: 0.058290
Step 2600 took 0.007365 seconds. Loss: 0.050957
Step 2700 took 0.007160 seconds. Loss: 0.082629
Step 2800 took 0.007079 seconds. Loss: 0.063696
Step 2900 took 0.007109 seconds. Loss: 0.002865
Doing evaluation for test
accuracy: 0.983700
20 10 0.1
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.008  0.006  0.005  0.026  0.01   0.008  0.008  0.011  0.016  0.001]
[  3.473e-05   1.355e-04   3.518e-04   3.125e-04   4.916e-04   8.630e-05
   4.621e-04   6.672e-05   1.592e-04   1.474e-04]
[  1.018e-04   3.344e-04   3.058e-04   1.736e-05   1.612e-05   3.092e-04
   1.920e-05   3.592e-04   8.133e-05   2.445e-05]
[ 0.001  0.009  0.009  0.001  0.007  0.002  0.002  0.004  0.     0.002]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.051075 seconds. Loss: 2.301866
Step 100 took 0.007495 seconds. Loss: 0.844557
Step 200 took 0.006800 seconds. Loss: 0.624235
Step 300 took 0.006738 seconds. Loss: 0.425553
Step 400 took 0.006815 seconds. Loss: 0.316246
Step 500 took 0.006797 seconds. Loss: 0.254775
Step 600 took 0.056267 seconds. Loss: 0.250976
Doing evaluation for test
accuracy: 0.933000
Step 700 took 0.007232 seconds. Loss: 0.264522
Step 800 took 0.006864 seconds. Loss: 0.302468
Step 900 took 0.007445 seconds. Loss: 0.140398
Step 1000 took 0.007759 seconds. Loss: 0.250852
Step 1100 took 0.008198 seconds. Loss: 0.154182
Step 1200 took 0.061162 seconds. Loss: 0.166503
Doing evaluation for test
accuracy: 0.960600
Step 1300 took 0.006936 seconds. Loss: 0.126581
Step 1400 took 0.007265 seconds. Loss: 0.146764
Step 1500 took 0.007328 seconds. Loss: 0.215642
Step 1600 took 0.007160 seconds. Loss: 0.099910
Step 1700 took 0.006980 seconds. Loss: 0.047004
Step 1800 took 0.073877 seconds. Loss: 0.048989
Doing evaluation for test
accuracy: 0.967100
Step 1900 took 0.007206 seconds. Loss: 0.096018
Step 2000 took 0.007044 seconds. Loss: 0.144072
Step 2100 took 0.006990 seconds. Loss: 0.133729
Step 2200 took 0.007634 seconds. Loss: 0.162545
Step 2300 took 0.007561 seconds. Loss: 0.032316
Step 2400 took 0.076220 seconds. Loss: 0.015070
Doing evaluation for test
accuracy: 0.974200
Step 2500 took 0.007113 seconds. Loss: 0.066428
Step 2600 took 0.006792 seconds. Loss: 0.059085
Step 2700 took 0.006844 seconds. Loss: 0.066210
Step 2800 took 0.008015 seconds. Loss: 0.083832
Step 2900 took 0.008016 seconds. Loss: 0.044828
Doing evaluation for test
accuracy: 0.975700
20 10 0.03
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.004  0.009  0.001  0.012  0.007  0.001  0.003  0.003  0.014  0.007]
[  3.898e-04   4.661e-04   6.789e-05   4.958e-04   1.976e-05   2.376e-04
   5.537e-04   1.210e-04   4.315e-04   2.334e-04]
[  1.304e-04   7.741e-05   1.526e-04   1.520e-04   2.298e-04   5.494e-05
   2.290e-04   6.964e-05   1.819e-05   3.458e-04]
[ 0.004  0.009  0.004  0.003  0.005  0.022  0.     0.003  0.002  0.001]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.054544 seconds. Loss: 2.301866
Step 100 took 0.006999 seconds. Loss: 2.187527
Step 200 took 0.006729 seconds. Loss: 1.817522
Step 300 took 0.006814 seconds. Loss: 0.995962
Step 400 took 0.006830 seconds. Loss: 0.514394
Step 500 took 0.007210 seconds. Loss: 0.496750
Step 600 took 0.070722 seconds. Loss: 0.429395
Doing evaluation for test
accuracy: 0.879000
Step 700 took 0.007129 seconds. Loss: 0.421590
Step 800 took 0.007830 seconds. Loss: 0.315969
Step 900 took 0.007547 seconds. Loss: 0.491994
Step 1000 took 0.007056 seconds. Loss: 0.298924
Step 1100 took 0.007398 seconds. Loss: 0.181440
Step 1200 took 0.070216 seconds. Loss: 0.160191
Doing evaluation for test
accuracy: 0.917600
Step 1300 took 0.006918 seconds. Loss: 0.396048
Step 1400 took 0.006820 seconds. Loss: 0.222706
Step 1500 took 0.007138 seconds. Loss: 0.211140
Step 1600 took 0.007603 seconds. Loss: 0.188012
Step 1700 took 0.006887 seconds. Loss: 0.211779
Step 1800 took 0.054183 seconds. Loss: 0.324566
Doing evaluation for test
accuracy: 0.924800
Step 1900 took 0.006985 seconds. Loss: 0.299887
Step 2000 took 0.007055 seconds. Loss: 0.192010
Step 2100 took 0.007134 seconds. Loss: 0.182242
Step 2200 took 0.007641 seconds. Loss: 0.268421
Step 2300 took 0.006946 seconds. Loss: 0.311154
Step 2400 took 0.076325 seconds. Loss: 0.101169
Doing evaluation for test
accuracy: 0.939100
Step 2500 took 0.007369 seconds. Loss: 0.330614
Step 2600 took 0.007253 seconds. Loss: 0.127467
Step 2700 took 0.007576 seconds. Loss: 0.144316
Step 2800 took 0.007546 seconds. Loss: 0.090287
Step 2900 took 0.008564 seconds. Loss: 0.110309
Doing evaluation for test
accuracy: 0.952200
20 10 0.01
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.007  0.015  0.001  0.002  0.002  0.001  0.003  0.001  0.005  0.005]
[  3.134e-04   4.793e-04   3.461e-04   2.287e-04   2.442e-04   9.585e-04
   2.089e-04   2.435e-04   2.696e-04   2.807e-05]
[  7.890e-07   3.158e-04   1.361e-04   3.491e-04   1.163e-04   7.336e-05
   1.222e-04   2.278e-04   2.558e-04   8.872e-05]
[ 0.002  0.     0.002  0.004  0.     0.008  0.005  0.002  0.001  0.003]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.056143 seconds. Loss: 2.301866
Step 100 took 0.006707 seconds. Loss: 2.276265
Step 200 took 0.007260 seconds. Loss: 2.248908
Step 300 took 0.006817 seconds. Loss: 2.213278
Step 400 took 0.007221 seconds. Loss: 2.087448
Step 500 took 0.007200 seconds. Loss: 1.980113
Step 600 took 0.056558 seconds. Loss: 1.718651
Doing evaluation for test
accuracy: 0.651900
Step 700 took 0.006690 seconds. Loss: 1.430576
Step 800 took 0.006769 seconds. Loss: 1.102285
Step 900 took 0.007026 seconds. Loss: 0.907316
Step 1000 took 0.007026 seconds. Loss: 0.765314
Step 1100 took 0.007482 seconds. Loss: 0.681361
Step 1200 took 0.071613 seconds. Loss: 0.548180
Doing evaluation for test
accuracy: 0.849600
Step 1300 took 0.006801 seconds. Loss: 0.556322
Step 1400 took 0.007342 seconds. Loss: 0.396578
Step 1500 took 0.007416 seconds. Loss: 0.590929
Step 1600 took 0.007078 seconds. Loss: 0.511468
Step 1700 took 0.007244 seconds. Loss: 0.415072
Step 1800 took 0.071782 seconds. Loss: 0.391358
Doing evaluation for test
accuracy: 0.886300
Step 1900 took 0.007058 seconds. Loss: 0.495191
Step 2000 took 0.009381 seconds. Loss: 0.325304
Step 2100 took 0.006899 seconds. Loss: 0.352279
Step 2200 took 0.015608 seconds. Loss: 0.396146
Step 2300 took 0.006650 seconds. Loss: 0.322828
Step 2400 took 0.055021 seconds. Loss: 0.353082
Doing evaluation for test
accuracy: 0.905100
Step 2500 took 0.007750 seconds. Loss: 0.305162
Step 2600 took 0.007968 seconds. Loss: 0.400114
Step 2700 took 0.007501 seconds. Loss: 0.239981
Step 2800 took 0.006929 seconds. Loss: 0.271004
Step 2900 took 0.007250 seconds. Loss: 0.322361
Doing evaluation for test
accuracy: 0.911100
20 20 0.3
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.011  0.009  0.024  0.002  0.     0.004  0.005  0.011  0.014  0.008]
[  1.741e-04   1.281e-04   2.063e-06   7.819e-05   9.418e-04   4.877e-05
   5.134e-04   2.165e-04   2.220e-05   1.800e-04]
[  6.579e-05   6.498e-05   1.210e-04   3.388e-04   1.316e-05   9.354e-05
   3.563e-04   1.329e-05   2.537e-05   1.250e-05]
[ 0.002  0.006  0.001  0.004  0.     0.004  0.008  0.007  0.002  0.002]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.057282 seconds. Loss: 2.302286
Step 100 took 0.006851 seconds. Loss: 0.326250
Step 200 took 0.006903 seconds. Loss: 0.262928
Step 300 took 0.008014 seconds. Loss: 0.215866
Step 400 took 0.006902 seconds. Loss: 0.132459
Step 500 took 0.006871 seconds. Loss: 0.073187
Step 600 took 0.052448 seconds. Loss: 0.078815
Doing evaluation for test
accuracy: 0.970200
Step 700 took 0.006767 seconds. Loss: 0.217789
Step 800 took 0.007253 seconds. Loss: 0.037967
Step 900 took 0.007641 seconds. Loss: 0.170390
Step 1000 took 0.007071 seconds. Loss: 0.162628
Step 1100 took 0.009923 seconds. Loss: 0.052757
Step 1200 took 0.092840 seconds. Loss: 0.032990
Doing evaluation for test
accuracy: 0.979800
Step 1300 took 0.007671 seconds. Loss: 0.007701
Step 1400 took 0.007597 seconds. Loss: 0.012115
Step 1500 took 0.007084 seconds. Loss: 0.010931
Step 1600 took 0.007239 seconds. Loss: 0.083912
Step 1700 took 0.007171 seconds. Loss: 0.048228
Step 1800 took 0.052144 seconds. Loss: 0.073014
Doing evaluation for test
accuracy: 0.977700
Step 1900 took 0.006675 seconds. Loss: 0.018039
Step 2000 took 0.007143 seconds. Loss: 0.040822
Step 2100 took 0.007030 seconds. Loss: 0.016128
Step 2200 took 0.007128 seconds. Loss: 0.023789
Step 2300 took 0.007145 seconds. Loss: 0.265597
Step 2400 took 0.078093 seconds. Loss: 0.031155
Doing evaluation for test
accuracy: 0.981900
Step 2500 took 0.007771 seconds. Loss: 0.010389
Step 2600 took 0.007528 seconds. Loss: 0.077580
Step 2700 took 0.007415 seconds. Loss: 0.031311
Step 2800 took 0.007062 seconds. Loss: 0.030350
Step 2900 took 0.007598 seconds. Loss: 0.024963
Doing evaluation for test
accuracy: 0.983600
20 20 0.1
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.001  0.001  0.002  0.002  0.02   0.     0.002  0.005  0.01   0.004]
[  1.398e-04   4.562e-04   2.001e-04   7.255e-05   2.604e-04   1.810e-04
   9.605e-05   2.163e-04   6.574e-05   2.089e-05]
[  2.154e-04   7.136e-05   1.800e-05   1.090e-04   2.496e-04   1.324e-04
   1.576e-04   9.115e-05   1.812e-05   2.072e-04]
[  3.732e-03   6.496e-03   4.942e-03   6.784e-03   2.049e-03   2.969e-03
   3.646e-03   3.605e-03   2.300e-03   1.480e-05]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.057643 seconds. Loss: 2.302286
Step 100 took 0.007269 seconds. Loss: 0.493932
Step 200 took 0.006895 seconds. Loss: 0.499926
Step 300 took 0.006795 seconds. Loss: 0.304058
Step 400 took 0.007199 seconds. Loss: 0.210494
Step 500 took 0.007104 seconds. Loss: 0.166708
Step 600 took 0.072231 seconds. Loss: 0.115861
Doing evaluation for test
accuracy: 0.949100
Step 700 took 0.007778 seconds. Loss: 0.182338
Step 800 took 0.007223 seconds. Loss: 0.172477
Step 900 took 0.007167 seconds. Loss: 0.121704
Step 1000 took 0.007025 seconds. Loss: 0.078116
Step 1100 took 0.006617 seconds. Loss: 0.119427
Step 1200 took 0.068990 seconds. Loss: 0.031807
Doing evaluation for test
accuracy: 0.969100
Step 1300 took 0.006871 seconds. Loss: 0.128242
Step 1400 took 0.006917 seconds. Loss: 0.147048
Step 1500 took 0.006825 seconds. Loss: 0.119366
Step 1600 took 0.007360 seconds. Loss: 0.058912
Step 1700 took 0.006872 seconds. Loss: 0.022286
Step 1800 took 0.115423 seconds. Loss: 0.077501
Doing evaluation for test
accuracy: 0.971100
Step 1900 took 0.008013 seconds. Loss: 0.114533
Step 2000 took 0.007503 seconds. Loss: 0.095241
Step 2100 took 0.007174 seconds. Loss: 0.038378
Step 2200 took 0.007447 seconds. Loss: 0.027091
Step 2300 took 0.006617 seconds. Loss: 0.028816
Step 2400 took 0.064333 seconds. Loss: 0.018721
Doing evaluation for test
accuracy: 0.979900
Step 2500 took 0.006655 seconds. Loss: 0.060787
Step 2600 took 0.007141 seconds. Loss: 0.137832
Step 2700 took 0.007142 seconds. Loss: 0.030953
Step 2800 took 0.007107 seconds. Loss: 0.083397
Step 2900 took 0.007366 seconds. Loss: 0.049374
Doing evaluation for test
accuracy: 0.982400
20 20 0.03
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.019  0.001  0.009  0.008  0.031  0.004  0.006  0.003  0.008  0.012]
[  2.477e-04   3.002e-05   4.036e-04   5.681e-04   3.981e-05   7.507e-04
   3.302e-04   3.513e-04   1.281e-05   4.330e-05]
[  1.773e-04   1.401e-04   4.153e-05   2.257e-04   5.291e-05   1.673e-04
   2.350e-05   1.507e-05   2.801e-04   1.493e-04]
[ 0.005  0.003  0.001  0.008  0.004  0.003  0.003  0.003  0.     0.002]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.064059 seconds. Loss: 2.302286
Step 100 took 0.006749 seconds. Loss: 1.529092
Step 200 took 0.006977 seconds. Loss: 0.734046
Step 300 took 0.007306 seconds. Loss: 0.528032
Step 400 took 0.006988 seconds. Loss: 0.387583
Step 500 took 0.006891 seconds. Loss: 0.347370
Step 600 took 0.075563 seconds. Loss: 0.389825
Doing evaluation for test
accuracy: 0.907000
Step 700 took 0.007676 seconds. Loss: 0.244870
Step 800 took 0.007148 seconds. Loss: 0.311082
Step 900 took 0.006975 seconds. Loss: 0.283894
Step 1000 took 0.007487 seconds. Loss: 0.234556
Step 1100 took 0.007398 seconds. Loss: 0.150171
Step 1200 took 0.054085 seconds. Loss: 0.245659
Doing evaluation for test
accuracy: 0.939400
Step 1300 took 0.007036 seconds. Loss: 0.216924
Step 1400 took 0.007420 seconds. Loss: 0.183459
Step 1500 took 0.007620 seconds. Loss: 0.222693
Step 1600 took 0.006970 seconds. Loss: 0.113761
Step 1700 took 0.007073 seconds. Loss: 0.112089
Step 1800 took 0.061952 seconds. Loss: 0.140442
Doing evaluation for test
accuracy: 0.953900
Step 1900 took 0.006650 seconds. Loss: 0.126285
Step 2000 took 0.006737 seconds. Loss: 0.144851
Step 2100 took 0.007363 seconds. Loss: 0.190689
Step 2200 took 0.007234 seconds. Loss: 0.183549
Step 2300 took 0.007049 seconds. Loss: 0.120706
Step 2400 took 0.074283 seconds. Loss: 0.133803
Doing evaluation for test
accuracy: 0.960300
Step 2500 took 0.007153 seconds. Loss: 0.120287
Step 2600 took 0.007138 seconds. Loss: 0.192268
Step 2700 took 0.008072 seconds. Loss: 0.163432
Step 2800 took 0.007690 seconds. Loss: 0.057545
Step 2900 took 0.007118 seconds. Loss: 0.027203
Doing evaluation for test
accuracy: 0.965300
20 20 0.01
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.006  0.003  0.002  0.012  0.004  0.003  0.011  0.002  0.003  0.002]
[  1.487e-05   1.330e-04   2.992e-04   1.192e-04   2.782e-04   8.235e-05
   1.286e-04   1.438e-05   1.092e-04   3.578e-04]
[  1.558e-04   1.078e-05   4.826e-05   2.020e-04   2.853e-05   8.664e-05
   3.087e-06   5.103e-04   4.252e-04   5.040e-04]
[ 0.008  0.008  0.005  0.     0.003  0.002  0.009  0.002  0.001  0.001]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.081646 seconds. Loss: 2.302286
Step 100 took 0.006792 seconds. Loss: 2.184179
Step 200 took 0.008820 seconds. Loss: 2.004461
Step 300 took 0.006914 seconds. Loss: 1.626508
Step 400 took 0.007139 seconds. Loss: 0.938325
Step 500 took 0.007296 seconds. Loss: 0.744224
Step 600 took 0.065122 seconds. Loss: 0.722142
Doing evaluation for test
accuracy: 0.841500
Step 700 took 0.006928 seconds. Loss: 0.591772
Step 800 took 0.006957 seconds. Loss: 0.517253
Step 900 took 0.007185 seconds. Loss: 0.375777
Step 1000 took 0.008059 seconds. Loss: 0.497596
Step 1100 took 0.006952 seconds. Loss: 0.422617
Step 1200 took 0.066293 seconds. Loss: 0.458232
Doing evaluation for test
accuracy: 0.899500
Step 1300 took 0.007674 seconds. Loss: 0.380383
Step 1400 took 0.008063 seconds. Loss: 0.536169
Step 1500 took 0.007742 seconds. Loss: 0.441508
Step 1600 took 0.007607 seconds. Loss: 0.391884
Step 1700 took 0.007243 seconds. Loss: 0.213176
Step 1800 took 0.077019 seconds. Loss: 0.340222
Doing evaluation for test
accuracy: 0.915800
Step 1900 took 0.006870 seconds. Loss: 0.311239
Step 2000 took 0.007549 seconds. Loss: 0.263402
Step 2100 took 0.006891 seconds. Loss: 0.369663
Step 2200 took 0.007243 seconds. Loss: 0.242158
Step 2300 took 0.007263 seconds. Loss: 0.229711
Step 2400 took 0.063106 seconds. Loss: 0.282362
Doing evaluation for test
accuracy: 0.926400
Step 2500 took 0.006791 seconds. Loss: 0.275018
Step 2600 took 0.006714 seconds. Loss: 0.207383
Step 2700 took 0.007230 seconds. Loss: 0.382677
Step 2800 took 0.007203 seconds. Loss: 0.202287
Step 2900 took 0.007046 seconds. Loss: 0.190023
Doing evaluation for test
accuracy: 0.932200
20 50 0.3
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.004  0.008  0.001  0.005  0.003  0.013  0.004  0.004  0.004  0.001]
[  3.049e-05   5.847e-04   1.271e-05   2.691e-04   3.365e-04   7.269e-04
   1.748e-04   1.838e-04   1.202e-04   3.116e-04]
[  2.028e-04   1.593e-09   1.378e-04   4.399e-06   1.037e-04   4.431e-05
   2.249e-04   2.877e-04   6.984e-05   1.460e-04]
[ 0.003  0.003  0.005  0.002  0.005  0.002  0.002  0.001  0.     0.007]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.070904 seconds. Loss: 2.310182
Step 100 took 0.006585 seconds. Loss: 0.206600
Step 200 took 0.006916 seconds. Loss: 0.195324
Step 300 took 0.006897 seconds. Loss: 0.208990
Step 400 took 0.006843 seconds. Loss: 0.073763
Step 500 took 0.006867 seconds. Loss: 0.063428
Step 600 took 0.056743 seconds. Loss: 0.055403
Doing evaluation for test
accuracy: 0.972600
Step 700 took 0.007263 seconds. Loss: 0.022761
Step 800 took 0.007282 seconds. Loss: 0.022359
Step 900 took 0.007124 seconds. Loss: 0.136544
Step 1000 took 0.006973 seconds. Loss: 0.075164
Step 1100 took 0.007452 seconds. Loss: 0.008587
Step 1200 took 0.070336 seconds. Loss: 0.049292
Doing evaluation for test
accuracy: 0.981000
Step 1300 took 0.007308 seconds. Loss: 0.010154
Step 1400 took 0.007248 seconds. Loss: 0.004663
Step 1500 took 0.007167 seconds. Loss: 0.038309
Step 1600 took 0.006749 seconds. Loss: 0.048180
Step 1700 took 0.007753 seconds. Loss: 0.036382
Step 1800 took 0.076186 seconds. Loss: 0.019602
Doing evaluation for test
accuracy: 0.984400
Step 1900 took 0.007379 seconds. Loss: 0.024125
Step 2000 took 0.006866 seconds. Loss: 0.007612
Step 2100 took 0.007696 seconds. Loss: 0.073603
Step 2200 took 0.007189 seconds. Loss: 0.039326
Step 2300 took 0.008983 seconds. Loss: 0.010192
Step 2400 took 0.055118 seconds. Loss: 0.026848
Doing evaluation for test
accuracy: 0.984100
Step 2500 took 0.006684 seconds. Loss: 0.028484
Step 2600 took 0.006966 seconds. Loss: 0.002882
Step 2700 took 0.007189 seconds. Loss: 0.056624
Step 2800 took 0.006982 seconds. Loss: 0.015310
Step 2900 took 0.007143 seconds. Loss: 0.111834
Doing evaluation for test
accuracy: 0.980800
20 50 0.1
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.009  0.012  0.009  0.     0.009  0.001  0.     0.008  0.005  0.008]
[  5.512e-04   7.825e-05   2.170e-04   1.808e-04   1.385e-05   7.438e-05
   9.634e-05   4.191e-04   4.033e-04   5.523e-04]
[  1.918e-04   1.171e-04   2.097e-04   1.234e-05   1.094e-05   5.479e-05
   1.366e-04   5.414e-05   5.916e-05   1.380e-04]
[ 0.008  0.001  0.002  0.002  0.004  0.001  0.007  0.001  0.002  0.006]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.069768 seconds. Loss: 2.310182
Step 100 took 0.006772 seconds. Loss: 0.323269
Step 200 took 0.006972 seconds. Loss: 0.330216
Step 300 took 0.006801 seconds. Loss: 0.224393
Step 400 took 0.006889 seconds. Loss: 0.144546
Step 500 took 0.007102 seconds. Loss: 0.089244
Step 600 took 0.070390 seconds. Loss: 0.087517
Doing evaluation for test
accuracy: 0.961800
Step 700 took 0.007904 seconds. Loss: 0.127805
Step 800 took 0.007157 seconds. Loss: 0.114049
Step 900 took 0.006879 seconds. Loss: 0.226610
Step 1000 took 0.006958 seconds. Loss: 0.081919
Step 1100 took 0.007139 seconds. Loss: 0.053236
Step 1200 took 0.058579 seconds. Loss: 0.054657
Doing evaluation for test
accuracy: 0.977700
Step 1300 took 0.006572 seconds. Loss: 0.019645
Step 1400 took 0.006792 seconds. Loss: 0.031688
Step 1500 took 0.007120 seconds. Loss: 0.040423
Step 1600 took 0.007490 seconds. Loss: 0.074137
Step 1700 took 0.007217 seconds. Loss: 0.044449
Step 1800 took 0.075644 seconds. Loss: 0.026847
Doing evaluation for test
accuracy: 0.982000
Step 1900 took 0.007770 seconds. Loss: 0.072741
Step 2000 took 0.006996 seconds. Loss: 0.045067
Step 2100 took 0.007212 seconds. Loss: 0.134199
Step 2200 took 0.007415 seconds. Loss: 0.035202
Step 2300 took 0.009081 seconds. Loss: 0.034326
Step 2400 took 0.055066 seconds. Loss: 0.085349
Doing evaluation for test
accuracy: 0.980200
Step 2500 took 0.007499 seconds. Loss: 0.048842
Step 2600 took 0.007274 seconds. Loss: 0.007937
Step 2700 took 0.007023 seconds. Loss: 0.026842
Step 2800 took 0.008457 seconds. Loss: 0.059949
Step 2900 took 0.007138 seconds. Loss: 0.041050
Doing evaluation for test
accuracy: 0.985000
20 50 0.03
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.     0.005  0.018  0.003  0.035  0.014  0.003  0.004  0.001  0.003]
[  2.800e-04   1.684e-04   1.612e-04   1.561e-04   1.333e-04   1.217e-04
   3.452e-04   2.208e-04   6.337e-05   3.958e-04]
[  6.622e-05   6.757e-05   1.080e-04   1.353e-04   1.278e-04   5.779e-05
   1.319e-04   1.051e-04   1.237e-04   1.426e-04]
[  7.874e-03   9.398e-03   6.714e-05   4.968e-04   4.442e-03   8.068e-03
   5.782e-03   7.147e-03   9.560e-04   9.420e-03]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.073421 seconds. Loss: 2.310182
Step 100 took 0.007141 seconds. Loss: 0.548027
Step 200 took 0.006942 seconds. Loss: 0.553672
Step 300 took 0.007027 seconds. Loss: 0.379213
Step 400 took 0.006896 seconds. Loss: 0.266939
Step 500 took 0.006858 seconds. Loss: 0.224626
Step 600 took 0.054393 seconds. Loss: 0.254516
Doing evaluation for test
accuracy: 0.932500
Step 700 took 0.007174 seconds. Loss: 0.225169
Step 800 took 0.006851 seconds. Loss: 0.109523
Step 900 took 0.007214 seconds. Loss: 0.244942
Step 1000 took 0.007239 seconds. Loss: 0.152747
Step 1100 took 0.007029 seconds. Loss: 0.195770
Step 1200 took 0.052521 seconds. Loss: 0.131309
Doing evaluation for test
accuracy: 0.959700
Step 1300 took 0.007439 seconds. Loss: 0.252945
Step 1400 took 0.006919 seconds. Loss: 0.130406
Step 1500 took 0.007438 seconds. Loss: 0.081989
Step 1600 took 0.007294 seconds. Loss: 0.106588
Step 1700 took 0.007060 seconds. Loss: 0.121891
Step 1800 took 0.079965 seconds. Loss: 0.167423
Doing evaluation for test
accuracy: 0.960400
Step 1900 took 0.009259 seconds. Loss: 0.042221
Step 2000 took 0.007558 seconds. Loss: 0.099370
Step 2100 took 0.007125 seconds. Loss: 0.068249
Step 2200 took 0.007195 seconds. Loss: 0.122829
Step 2300 took 0.007608 seconds. Loss: 0.102432
Step 2400 took 0.066642 seconds. Loss: 0.084139
Doing evaluation for test
accuracy: 0.973500
Step 2500 took 0.006845 seconds. Loss: 0.083287
Step 2600 took 0.007259 seconds. Loss: 0.121152
Step 2700 took 0.007173 seconds. Loss: 0.129978
Step 2800 took 0.007327 seconds. Loss: 0.059326
Step 2900 took 0.007151 seconds. Loss: 0.060922
Doing evaluation for test
accuracy: 0.973700
20 50 0.01
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[  3.899e-03   2.250e-02   1.026e-03   8.711e-05   7.413e-04   6.859e-03
   5.916e-03   7.302e-03   1.543e-03   4.883e-03]
[  3.225e-05   2.239e-04   7.456e-05   1.562e-04   7.808e-05   5.979e-04
   2.567e-04   6.029e-04   3.244e-05   1.196e-03]
[  8.501e-06   4.842e-04   1.588e-05   2.008e-04   3.466e-05   7.464e-06
   2.616e-04   3.524e-04   2.171e-05   1.270e-05]
[  4.451e-04   3.948e-05   1.458e-02   5.313e-03   1.237e-02   8.257e-04
   3.434e-03   5.209e-04   1.770e-03   2.998e-03]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.073074 seconds. Loss: 2.310182
Step 100 took 0.008229 seconds. Loss: 1.410705
Step 200 took 0.006777 seconds. Loss: 0.832566
Step 300 took 0.006841 seconds. Loss: 0.598075
Step 400 took 0.006881 seconds. Loss: 0.380570
Step 500 took 0.007351 seconds. Loss: 0.396398
Step 600 took 0.060998 seconds. Loss: 0.364075
Doing evaluation for test
accuracy: 0.900600
Step 700 took 0.007176 seconds. Loss: 0.316166
Step 800 took 0.007553 seconds. Loss: 0.227288
Step 900 took 0.007300 seconds. Loss: 0.345677
Step 1000 took 0.007284 seconds. Loss: 0.192733
Step 1100 took 0.007379 seconds. Loss: 0.256509
Step 1200 took 0.069307 seconds. Loss: 0.196314
Doing evaluation for test
accuracy: 0.929800
Step 1300 took 0.006747 seconds. Loss: 0.194561
Step 1400 took 0.006886 seconds. Loss: 0.244334
Step 1500 took 0.007524 seconds. Loss: 0.356290
Step 1600 took 0.006968 seconds. Loss: 0.293802
Step 1700 took 0.007291 seconds. Loss: 0.126035
Step 1800 took 0.055471 seconds. Loss: 0.216421
Doing evaluation for test
accuracy: 0.942000
Step 1900 took 0.007201 seconds. Loss: 0.224688
Step 2000 took 0.007908 seconds. Loss: 0.328770
Step 2100 took 0.010671 seconds. Loss: 0.296383
Step 2200 took 0.006968 seconds. Loss: 0.230175
Step 2300 took 0.006994 seconds. Loss: 0.196388
Step 2400 took 0.070541 seconds. Loss: 0.185989
Doing evaluation for test
accuracy: 0.950800
Step 2500 took 0.006828 seconds. Loss: 0.244235
Step 2600 took 0.006737 seconds. Loss: 0.150136
Step 2700 took 0.007506 seconds. Loss: 0.195110
Step 2800 took 0.007237 seconds. Loss: 0.324397
Step 2900 took 0.007360 seconds. Loss: 0.227618
Doing evaluation for test
accuracy: 0.956600
50 10 0.3
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.02   0.005  0.002  0.004  0.018  0.006  0.002  0.003  0.041  0.009]
[  2.225e-05   3.305e-05   7.624e-05   2.793e-05   2.534e-04   2.646e-04
   2.557e-05   2.976e-04   7.050e-05   2.196e-04]
[  1.244e-04   3.778e-05   1.880e-04   1.091e-05   3.524e-05   2.866e-05
   6.104e-05   2.569e-04   7.920e-06   4.480e-05]
[ 0.003  0.002  0.003  0.016  0.008  0.009  0.012  0.007  0.001  0.006]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.077899 seconds. Loss: 2.403385
Step 100 took 0.007128 seconds. Loss: 0.437099
Model diverged with loss = NaN
50 10 0.1
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.004  0.004  0.025  0.005  0.005  0.     0.005  0.001  0.01   0.004]
[  9.798e-05   4.059e-04   2.706e-04   1.049e-04   3.119e-04   7.007e-05
   4.879e-05   1.259e-04   9.794e-05   6.494e-04]
[  5.468e-04   2.001e-04   3.552e-04   1.754e-04   3.242e-05   2.187e-06
   1.644e-04   1.853e-05   3.767e-05   1.622e-04]
[ 0.001  0.012  0.     0.006  0.011  0.014  0.005  0.003  0.006  0.003]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.079263 seconds. Loss: 2.403385
Step 100 took 0.006972 seconds. Loss: 0.227206
Step 200 took 0.007151 seconds. Loss: 0.366047
Step 300 took 0.006964 seconds. Loss: 0.184417
Step 400 took 0.006805 seconds. Loss: 0.142794
Step 500 took 0.006853 seconds. Loss: 0.065534
Step 600 took 0.054307 seconds. Loss: 0.063211
Doing evaluation for test
accuracy: 0.973300
Step 700 took 0.007026 seconds. Loss: 0.112755
Step 800 took 0.008588 seconds. Loss: 0.096847
Step 900 took 0.006836 seconds. Loss: 0.034078
Step 1000 took 0.013417 seconds. Loss: 0.160363
Step 1100 took 0.006960 seconds. Loss: 0.036678
Step 1200 took 0.067636 seconds. Loss: 0.042386
Doing evaluation for test
accuracy: 0.979300
Step 1300 took 0.006913 seconds. Loss: 0.014846
Step 1400 took 0.006755 seconds. Loss: 0.044681
Step 1500 took 0.006891 seconds. Loss: 0.022514
Step 1600 took 0.007160 seconds. Loss: 0.061030
Step 1700 took 0.007200 seconds. Loss: 0.037843
Step 1800 took 0.062152 seconds. Loss: 0.065463
Doing evaluation for test
accuracy: 0.982900
Step 1900 took 0.006750 seconds. Loss: 0.019040
Step 2000 took 0.007030 seconds. Loss: 0.020172
Step 2100 took 0.006756 seconds. Loss: 0.049781
Step 2200 took 0.006791 seconds. Loss: 0.004604
Step 2300 took 0.006805 seconds. Loss: 0.009670
Step 2400 took 0.055761 seconds. Loss: 0.035290
Doing evaluation for test
accuracy: 0.983500
Step 2500 took 0.006783 seconds. Loss: 0.004024
Step 2600 took 0.006673 seconds. Loss: 0.011488
Step 2700 took 0.006967 seconds. Loss: 0.035991
Step 2800 took 0.007126 seconds. Loss: 0.002679
Step 2900 took 0.007379 seconds. Loss: 0.024090
Doing evaluation for test
accuracy: 0.984000
50 10 0.03
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[  1.490e-02   1.727e-02   1.096e-02   3.368e-03   4.644e-03   4.870e-02
   2.006e-02   2.372e-07   1.075e-02   6.869e-03]
[  3.116e-04   2.370e-04   3.866e-05   1.837e-04   6.727e-05   3.787e-05
   5.057e-04   9.750e-05   4.272e-05   2.622e-04]
[  1.506e-05   1.808e-04   3.918e-04   6.614e-05   1.265e-04   8.233e-05
   8.504e-05   5.001e-04   4.313e-05   4.728e-05]
[ 0.002  0.001  0.     0.004  0.     0.002  0.     0.003  0.011  0.   ]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.121315 seconds. Loss: 2.403385
Step 100 took 0.007908 seconds. Loss: 0.326085
Step 200 took 0.006884 seconds. Loss: 0.394347
Step 300 took 0.007148 seconds. Loss: 0.252799
Step 400 took 0.006992 seconds. Loss: 0.140727
Step 500 took 0.007010 seconds. Loss: 0.142936
Step 600 took 0.061640 seconds. Loss: 0.147049
Doing evaluation for test
accuracy: 0.960600
Step 700 took 0.006763 seconds. Loss: 0.060881
Step 800 took 0.006864 seconds. Loss: 0.177955
Step 900 took 0.007065 seconds. Loss: 0.104665
Step 1000 took 0.007215 seconds. Loss: 0.131253
Step 1100 took 0.007920 seconds. Loss: 0.151125
Step 1200 took 0.055787 seconds. Loss: 0.081735
Doing evaluation for test
accuracy: 0.970400
Step 1300 took 0.007098 seconds. Loss: 0.066457
Step 1400 took 0.006866 seconds. Loss: 0.082032
Step 1500 took 0.007000 seconds. Loss: 0.051715
Step 1600 took 0.007252 seconds. Loss: 0.038927
Step 1700 took 0.007761 seconds. Loss: 0.113110
Step 1800 took 0.067159 seconds. Loss: 0.111707
Doing evaluation for test
accuracy: 0.977700
Step 1900 took 0.007104 seconds. Loss: 0.114167
Step 2000 took 0.007099 seconds. Loss: 0.062744
Step 2100 took 0.006878 seconds. Loss: 0.041210
Step 2200 took 0.007666 seconds. Loss: 0.043209
Step 2300 took 0.007726 seconds. Loss: 0.039148
Step 2400 took 0.055536 seconds. Loss: 0.025203
Doing evaluation for test
accuracy: 0.980100
Step 2500 took 0.007149 seconds. Loss: 0.092832
Step 2600 took 0.007168 seconds. Loss: 0.063361
Step 2700 took 0.006906 seconds. Loss: 0.063492
Step 2800 took 0.007112 seconds. Loss: 0.051066
Step 2900 took 0.006762 seconds. Loss: 0.121263
Doing evaluation for test
accuracy: 0.983000
50 10 0.01
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.016  0.004  0.001  0.022  0.007  0.003  0.002  0.009  0.014  0.024]
[  7.703e-06   2.514e-04   1.021e-04   4.648e-04   1.016e-04   7.697e-05
   8.087e-05   3.639e-06   3.473e-04   7.449e-05]
[  7.625e-05   3.906e-05   3.269e-04   2.928e-05   1.950e-04   1.216e-04
   2.734e-04   8.279e-05   3.824e-05   5.205e-05]
[ 0.003  0.021  0.005  0.001  0.004  0.004  0.003  0.003  0.007  0.   ]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.083814 seconds. Loss: 2.403385
Step 100 took 0.006794 seconds. Loss: 0.491901
Step 200 took 0.006829 seconds. Loss: 0.511627
Step 300 took 0.006887 seconds. Loss: 0.389187
Step 400 took 0.007051 seconds. Loss: 0.294480
Step 500 took 0.007149 seconds. Loss: 0.249875
Step 600 took 0.061866 seconds. Loss: 0.334860
Doing evaluation for test
accuracy: 0.929600
Step 700 took 0.007345 seconds. Loss: 0.198557
Step 800 took 0.007036 seconds. Loss: 0.261990
Step 900 took 0.006991 seconds. Loss: 0.089923
Step 1000 took 0.007538 seconds. Loss: 0.095700
Step 1100 took 0.007087 seconds. Loss: 0.124479
Step 1200 took 0.057720 seconds. Loss: 0.097724
Doing evaluation for test
accuracy: 0.954800
Step 1300 took 0.007055 seconds. Loss: 0.109768
Step 1400 took 0.008339 seconds. Loss: 0.135101
Step 1500 took 0.007366 seconds. Loss: 0.141195
Step 1600 took 0.007054 seconds. Loss: 0.117974
Step 1700 took 0.007889 seconds. Loss: 0.179340
Step 1800 took 0.054387 seconds. Loss: 0.208168
Doing evaluation for test
accuracy: 0.963000
Step 1900 took 0.006894 seconds. Loss: 0.086545
Step 2000 took 0.006982 seconds. Loss: 0.127367
Step 2100 took 0.007077 seconds. Loss: 0.076763
Step 2200 took 0.007307 seconds. Loss: 0.100662
Step 2300 took 0.007895 seconds. Loss: 0.084927
Step 2400 took 0.064368 seconds. Loss: 0.161007
Doing evaluation for test
accuracy: 0.969600
Step 2500 took 0.007235 seconds. Loss: 0.138918
Step 2600 took 0.006727 seconds. Loss: 0.056457
Step 2700 took 0.006860 seconds. Loss: 0.082372
Step 2800 took 0.007575 seconds. Loss: 0.145205
Step 2900 took 0.007309 seconds. Loss: 0.206818
Doing evaluation for test
accuracy: 0.972500
50 20 0.3
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.007  0.035  0.014  0.006  0.006  0.     0.001  0.005  0.018  0.008]
[  5.737e-05   2.013e-04   4.265e-05   5.252e-04   2.173e-04   4.966e-05
   1.138e-04   1.473e-04   5.608e-05   9.986e-04]
[  2.998e-04   3.413e-04   4.716e-04   1.898e-04   1.673e-04   7.879e-05
   5.426e-04   3.405e-04   6.497e-05   1.861e-04]
[  1.069e-03   3.069e-03   5.595e-03   2.586e-03   3.300e-03   4.380e-05
   4.553e-03   8.154e-03   6.833e-04   8.468e-05]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.089669 seconds. Loss: 2.638451
Model diverged with loss = NaN
50 20 0.1
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[  1.547e-02   2.506e-04   1.815e-03   8.496e-03   1.636e-03   3.715e-03
   9.970e-03   1.421e-02   2.633e-05   2.871e-03]
[  4.465e-04   1.425e-04   6.996e-05   1.292e-03   3.178e-04   4.558e-05
   3.371e-04   1.092e-04   3.671e-04   9.491e-05]
[  4.805e-05   1.826e-04   3.595e-04   6.795e-05   5.297e-05   3.702e-06
   2.550e-04   9.082e-05   1.308e-04   3.159e-05]
[ 0.002  0.022  0.     0.     0.006  0.002  0.005  0.003  0.001  0.002]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.084506 seconds. Loss: 2.638451
Step 100 took 0.006657 seconds. Loss: 0.394952
Step 200 took 0.006633 seconds. Loss: 0.289957
Step 300 took 0.006928 seconds. Loss: 0.286692
Step 400 took 0.006830 seconds. Loss: 0.318683
Step 500 took 0.007013 seconds. Loss: 0.082340
Step 600 took 0.065649 seconds. Loss: 0.070424
Doing evaluation for test
accuracy: 0.969600
Step 700 took 0.006826 seconds. Loss: 0.080677
Step 800 took 0.006701 seconds. Loss: 0.076761
Step 900 took 0.006955 seconds. Loss: 0.108819
Step 1000 took 0.007083 seconds. Loss: 0.044848
Step 1100 took 0.007296 seconds. Loss: 0.100832
Step 1200 took 0.061564 seconds. Loss: 0.020991
Doing evaluation for test
accuracy: 0.978800
Step 1300 took 0.006730 seconds. Loss: 0.072762
Step 1400 took 0.006711 seconds. Loss: 0.014623
Step 1500 took 0.006944 seconds. Loss: 0.028581
Step 1600 took 0.006946 seconds. Loss: 0.045965
Step 1700 took 0.007024 seconds. Loss: 0.078896
Step 1800 took 0.064846 seconds. Loss: 0.027719
Doing evaluation for test
accuracy: 0.982100
Step 1900 took 0.006764 seconds. Loss: 0.004843
Step 2000 took 0.006990 seconds. Loss: 0.095195
Step 2100 took 0.006680 seconds. Loss: 0.009774
Step 2200 took 0.007371 seconds. Loss: 0.057125
Step 2300 took 0.006747 seconds. Loss: 0.018028
Step 2400 took 0.063281 seconds. Loss: 0.011416
Doing evaluation for test
accuracy: 0.982000
Step 2500 took 0.006884 seconds. Loss: 0.020679
Step 2600 took 0.006755 seconds. Loss: 0.016939
Step 2700 took 0.007092 seconds. Loss: 0.015287
Step 2800 took 0.007059 seconds. Loss: 0.006042
Step 2900 took 0.006771 seconds. Loss: 0.040175
Doing evaluation for test
accuracy: 0.981600
50 20 0.03
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.004  0.005  0.004  0.016  0.028  0.021  0.025  0.009  0.02   0.006]
[  1.747e-04   1.499e-04   6.138e-05   7.281e-04   1.520e-04   5.942e-05
   7.743e-05   5.204e-06   3.424e-04   1.130e-04]
[  1.980e-06   1.852e-06   6.668e-05   5.136e-05   5.627e-05   1.604e-04
   6.840e-05   7.361e-04   1.247e-04   2.047e-04]
[  9.655e-03   3.694e-03   5.260e-03   2.810e-03   3.495e-03   4.624e-04
   9.085e-03   8.700e-05   4.111e-03   1.181e-02]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.085855 seconds. Loss: 2.638451
Step 100 took 0.007466 seconds. Loss: 0.274511
Step 200 took 0.007294 seconds. Loss: 0.306050
Step 300 took 0.007225 seconds. Loss: 0.217979
Step 400 took 0.006672 seconds. Loss: 0.114157
Step 500 took 0.006800 seconds. Loss: 0.089917
Step 600 took 0.053642 seconds. Loss: 0.098565
Doing evaluation for test
accuracy: 0.956000
Step 700 took 0.007347 seconds. Loss: 0.168782
Step 800 took 0.006757 seconds. Loss: 0.084373
Step 900 took 0.007093 seconds. Loss: 0.120882
Step 1000 took 0.007663 seconds. Loss: 0.077406
Step 1100 took 0.006973 seconds. Loss: 0.073834
Step 1200 took 0.067900 seconds. Loss: 0.034315
Doing evaluation for test
accuracy: 0.976000
Step 1300 took 0.006832 seconds. Loss: 0.209335
Step 1400 took 0.008675 seconds. Loss: 0.092444
Step 1500 took 0.007095 seconds. Loss: 0.027370
Step 1600 took 0.007084 seconds. Loss: 0.028949
Step 1700 took 0.007008 seconds. Loss: 0.009231
Step 1800 took 0.057099 seconds. Loss: 0.032750
Doing evaluation for test
accuracy: 0.980400
Step 1900 took 0.007220 seconds. Loss: 0.048740
Step 2000 took 0.007315 seconds. Loss: 0.083655
Step 2100 took 0.007509 seconds. Loss: 0.030512
Step 2200 took 0.006912 seconds. Loss: 0.145074
Step 2300 took 0.007992 seconds. Loss: 0.009453
Step 2400 took 0.056980 seconds. Loss: 0.061039
Doing evaluation for test
accuracy: 0.982300
Step 2500 took 0.007103 seconds. Loss: 0.040576
Step 2600 took 0.007004 seconds. Loss: 0.019913
Step 2700 took 0.008132 seconds. Loss: 0.060410
Step 2800 took 0.007533 seconds. Loss: 0.051651
Step 2900 took 0.007767 seconds. Loss: 0.032956
Doing evaluation for test
accuracy: 0.984100
50 20 0.01
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.014  0.013  0.005  0.014  0.007  0.001  0.001  0.005  0.002  0.004]
[  7.743e-05   4.935e-05   1.436e-04   1.003e-04   5.532e-04   8.010e-06
   1.876e-04   1.434e-04   3.188e-05   1.189e-04]
[  5.122e-05   3.428e-04   3.986e-04   2.193e-04   3.630e-04   4.446e-05
   5.222e-05   1.277e-04   4.859e-05   5.181e-05]
[ 0.     0.001  0.001  0.008  0.01   0.001  0.004  0.006  0.002  0.008]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.139225 seconds. Loss: 2.638451
Step 100 took 0.006660 seconds. Loss: 0.350617
Step 200 took 0.007059 seconds. Loss: 0.466445
Step 300 took 0.006618 seconds. Loss: 0.380245
Step 400 took 0.007039 seconds. Loss: 0.172082
Step 500 took 0.007186 seconds. Loss: 0.187833
Step 600 took 0.075021 seconds. Loss: 0.151798
Doing evaluation for test
accuracy: 0.945100
Step 700 took 0.007817 seconds. Loss: 0.131479
Step 800 took 0.007928 seconds. Loss: 0.173791
Step 900 took 0.007443 seconds. Loss: 0.112602
Step 1000 took 0.007211 seconds. Loss: 0.135660
Step 1100 took 0.006830 seconds. Loss: 0.138028
Step 1200 took 0.061240 seconds. Loss: 0.065356
Doing evaluation for test
accuracy: 0.963700
Step 1300 took 0.006837 seconds. Loss: 0.159084
Step 1400 took 0.008817 seconds. Loss: 0.161958
Step 1500 took 0.006662 seconds. Loss: 0.137145
Step 1600 took 0.007069 seconds. Loss: 0.100949
Step 1700 took 0.006833 seconds. Loss: 0.124401
Step 1800 took 0.053885 seconds. Loss: 0.054574
Doing evaluation for test
accuracy: 0.972200
Step 1900 took 0.007103 seconds. Loss: 0.057428
Step 2000 took 0.007044 seconds. Loss: 0.099807
Step 2100 took 0.006998 seconds. Loss: 0.094889
Step 2200 took 0.006805 seconds. Loss: 0.127661
Step 2300 took 0.006876 seconds. Loss: 0.038670
Step 2400 took 0.060197 seconds. Loss: 0.049610
Doing evaluation for test
accuracy: 0.973600
Step 2500 took 0.006889 seconds. Loss: 0.062382
Step 2600 took 0.006743 seconds. Loss: 0.036022
Step 2700 took 0.006752 seconds. Loss: 0.063251
Step 2800 took 0.006783 seconds. Loss: 0.072932
Step 2900 took 0.007078 seconds. Loss: 0.035247
Doing evaluation for test
accuracy: 0.977700
50 50 0.3
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.044  0.001  0.001  0.002  0.003  0.002  0.016  0.014  0.007  0.034]
[  7.354e-05   4.280e-06   2.440e-05   3.332e-04   9.100e-05   1.525e-05
   1.999e-05   1.626e-04   4.568e-04   3.022e-04]
[  1.110e-05   1.544e-04   1.454e-05   2.418e-05   5.720e-05   1.037e-06
   2.337e-04   7.749e-05   1.315e-04   1.552e-04]
[ 0.001  0.001  0.001  0.004  0.001  0.     0.001  0.016  0.001  0.006]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.089357 seconds. Loss: 4.013833
Model diverged with loss = NaN
50 50 0.1
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.002  0.005  0.013  0.01   0.005  0.001  0.001  0.009  0.     0.06 ]
[  1.244e-04   4.851e-04   2.090e-04   2.225e-04   3.934e-05   2.209e-04
   4.916e-04   4.639e-04   3.905e-04   9.697e-05]
[  2.710e-04   1.557e-04   1.608e-04   2.067e-05   2.444e-05   2.932e-04
   2.717e-05   8.855e-05   5.239e-05   2.711e-05]
[  5.045e-03   6.761e-03   7.344e-03   4.406e-03   5.235e-04   1.661e-02
   5.742e-05   7.272e-03   2.783e-04   1.407e-03]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.091950 seconds. Loss: 4.013834
Model diverged with loss = NaN
50 50 0.03
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.013  0.001  0.014  0.006  0.005  0.003  0.006  0.008  0.002  0.011]
[  3.524e-04   6.239e-04   2.703e-04   1.572e-04   1.494e-05   3.494e-04
   3.288e-05   3.050e-04   1.678e-04   4.176e-04]
[  3.623e-05   9.675e-06   2.694e-04   2.236e-05   9.959e-05   1.028e-04
   4.104e-06   5.117e-05   5.360e-06   3.552e-04]
[ 0.001  0.     0.002  0.     0.008  0.001  0.01   0.001  0.001  0.001]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.100656 seconds. Loss: 4.013833
Step 100 took 0.006853 seconds. Loss: 0.432344
Step 200 took 0.006924 seconds. Loss: 0.241380
Step 300 took 0.006774 seconds. Loss: 0.207417
Step 400 took 0.006689 seconds. Loss: 0.295251
Step 500 took 0.006800 seconds. Loss: 0.106179
Step 600 took 0.054846 seconds. Loss: 0.082351
Doing evaluation for test
accuracy: 0.970100
Step 700 took 0.006857 seconds. Loss: 0.119572
Step 800 took 0.006790 seconds. Loss: 0.153189
Step 900 took 0.006777 seconds. Loss: 0.110081
Step 1000 took 0.006934 seconds. Loss: 0.188844
Step 1100 took 0.006527 seconds. Loss: 0.157774
Step 1200 took 0.063380 seconds. Loss: 0.031906
Doing evaluation for test
accuracy: 0.977900
Step 1300 took 0.007263 seconds. Loss: 0.032326
Step 1400 took 0.006848 seconds. Loss: 0.080872
Step 1500 took 0.007303 seconds. Loss: 0.027652
Step 1600 took 0.006953 seconds. Loss: 0.080173
Step 1700 took 0.006974 seconds. Loss: 0.045101
Step 1800 took 0.054718 seconds. Loss: 0.047024
Doing evaluation for test
accuracy: 0.982000
Step 1900 took 0.007386 seconds. Loss: 0.020685
Step 2000 took 0.006791 seconds. Loss: 0.053780
Step 2100 took 0.007258 seconds. Loss: 0.010781
Step 2200 took 0.007978 seconds. Loss: 0.013169
Step 2300 took 0.007698 seconds. Loss: 0.052873
Step 2400 took 0.052997 seconds. Loss: 0.057972
Doing evaluation for test
accuracy: 0.984100
Step 2500 took 0.007113 seconds. Loss: 0.018751
Step 2600 took 0.007329 seconds. Loss: 0.030625
Step 2700 took 0.008138 seconds. Loss: 0.021372
Step 2800 took 0.006854 seconds. Loss: 0.039629
Step 2900 took 0.007102 seconds. Loss: 0.026756
Doing evaluation for test
accuracy: 0.983000
50 50 0.01
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.     0.004  0.017  0.013  0.01   0.016  0.001  0.007  0.007  0.004]
[  5.546e-04   6.666e-06   3.699e-04   1.408e-05   5.627e-04   9.539e-05
   3.189e-05   1.528e-04   9.369e-05   9.165e-05]
[  4.268e-05   3.061e-05   5.222e-05   7.895e-07   2.643e-04   1.460e-04
   1.003e-04   4.025e-05   1.081e-06   8.717e-05]
[ 0.005  0.014  0.003  0.01   0.002  0.003  0.015  0.006  0.013  0.011]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.098901 seconds. Loss: 4.013834
Step 100 took 0.007012 seconds. Loss: 0.348911
Step 200 took 0.006956 seconds. Loss: 0.283150
Step 300 took 0.007276 seconds. Loss: 0.265887
Step 400 took 0.007191 seconds. Loss: 0.161933
Step 500 took 0.007285 seconds. Loss: 0.141262
Step 600 took 0.072562 seconds. Loss: 0.142465
Doing evaluation for test
accuracy: 0.957200
Step 700 took 0.007927 seconds. Loss: 0.039687
Step 800 took 0.008731 seconds. Loss: 0.090408
Step 900 took 0.007607 seconds. Loss: 0.296252
Step 1000 took 0.006850 seconds. Loss: 0.245744
Step 1100 took 0.009182 seconds. Loss: 0.085513
Step 1200 took 0.074437 seconds. Loss: 0.084753
Doing evaluation for test
accuracy: 0.969700
Step 1300 took 0.006789 seconds. Loss: 0.049577
Step 1400 took 0.006990 seconds. Loss: 0.037868
Step 1500 took 0.006719 seconds. Loss: 0.151365
Step 1600 took 0.006881 seconds. Loss: 0.114655
Step 1700 took 0.007001 seconds. Loss: 0.094666
Step 1800 took 0.056715 seconds. Loss: 0.012305
Doing evaluation for test
accuracy: 0.974200
Step 1900 took 0.006833 seconds. Loss: 0.072673
Step 2000 took 0.006973 seconds. Loss: 0.070497
Step 2100 took 0.007056 seconds. Loss: 0.086479
Step 2200 took 0.007007 seconds. Loss: 0.027154
Step 2300 took 0.007387 seconds. Loss: 0.036104
Step 2400 took 0.076338 seconds. Loss: 0.019218
Doing evaluation for test
accuracy: 0.978300
Step 2500 took 0.006932 seconds. Loss: 0.018163
Step 2600 took 0.007488 seconds. Loss: 0.019674
Step 2700 took 0.007025 seconds. Loss: 0.026688
Step 2800 took 0.007609 seconds. Loss: 0.036045
Step 2900 took 0.007164 seconds. Loss: 0.018351
Doing evaluation for test
accuracy: 0.979700
[([10, 10, 0.3], None), ([10, 10, 0.1], None), ([10, 10, 0.03], None), ([10, 10, 0.01], None), ([10, 20, 0.3], None), ([10, 20, 0.1], None), ([10, 20, 0.03], None), ([10, 20, 0.01], None), ([10, 50, 0.3], None), ([10, 50, 0.1], None), ([10, 50, 0.03], None), ([10, 50, 0.01], None), ([20, 10, 0.3], None), ([20, 10, 0.1], None), ([20, 10, 0.03], None), ([20, 10, 0.01], None), ([20, 20, 0.3], None), ([20, 20, 0.1], None), ([20, 20, 0.03], None), ([20, 20, 0.01], None), ([20, 50, 0.3], None), ([20, 50, 0.1], None), ([20, 50, 0.03], None), ([20, 50, 0.01], None), ([50, 10, 0.3], None), ([50, 10, 0.1], None), ([50, 10, 0.03], None), ([50, 10, 0.01], None), ([50, 20, 0.3], None), ([50, 20, 0.1], None), ([50, 20, 0.03], None), ([50, 20, 0.01], None), ([50, 50, 0.3], None), ([50, 50, 0.1], None), ([50, 50, 0.03], None), ([50, 50, 0.01], None)]
]0;optml@valiant: ~/holdenl/mwuoptml@valiant:~/holdenl/mwu$ python mwu.py 
  File "mwu.py", line 372
    [[10, 20, 50], [10, 20, 50], [0.3, 0.1, 0.03, 0.01]],
    ^
IndentationError: unexpected indent
Error in sys.excepthook:
Traceback (most recent call last):
  File "/usr/lib/python3/dist-packages/apport_python_hook.py", line 63, in apport_excepthook
    from apport.fileutils import likely_packaged, get_recent_crashes
  File "/usr/lib/python3/dist-packages/apport/__init__.py", line 5, in <module>
    from apport.report import Report
  File "/usr/lib/python3/dist-packages/apport/report.py", line 30, in <module>
    import apport.fileutils
  File "/usr/lib/python3/dist-packages/apport/fileutils.py", line 23, in <module>
    from apport.packaging_impl import impl as packaging
  File "/usr/lib/python3/dist-packages/apport/packaging_impl.py", line 23, in <module>
    import apt
  File "/usr/lib/python3/dist-packages/apt/__init__.py", line 23, in <module>
    import apt_pkg
ModuleNotFoundError: No module named 'apt_pkg'

Original exception was:
  File "mwu.py", line 372
    [[10, 20, 50], [10, 20, 50], [0.3, 0.1, 0.03, 0.01]],
    ^
IndentationError: unexpected indent
]0;optml@valiant: ~/holdenl/mwuoptml@valiant:~/holdenl/mwu$ python mwu.py 
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally
Using TensorFlow backend.
20 20 1
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.007  0.021  0.009  0.004  0.004  0.011  0.     0.002  0.005  0.004]
[  1.314e-04   1.440e-04   1.624e-04   3.821e-04   2.093e-04   5.389e-05
   5.001e-05   4.998e-04   5.533e-05   1.201e-03]
[  3.119e-04   1.069e-04   3.243e-05   3.690e-04   8.325e-05   5.384e-04
   8.718e-05   1.430e-04   3.354e-05   1.425e-04]
[ 0.008  0.002  0.001  0.     0.002  0.001  0.     0.003  0.009  0.007]
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties: 
name: TITAN X (Pascal)
major: 6 minor: 1 memoryClockRate (GHz) 1.531
pciBusID 0000:02:00.0
Total memory: 11.90GiB
Free memory: 11.75GiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x5278790
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 1 with properties: 
name: GeForce GTX 1080
major: 6 minor: 1 memoryClockRate (GHz) 1.7335
pciBusID 0000:01:00.0
Total memory: 7.92GiB
Free memory: 7.01GiB
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 0 and 1
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 1 and 0
I tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0 1 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y N 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 1:   N Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Traceback (most recent call last):
  File "mwu.py", line 378, in <module>
    ans = mnist_conv_test_gs(20,20,1, 3000,smoothing=0)
  File "mwu.py", line 346, in mnist_conv_test_gs
    return make_mwu_trainer_gs(model, ph_dict, Ws, bs, train_data, test_data, lr=lr,max_steps=max_steps, smoothing=smoothing)
  File "mwu.py", line 306, in make_mwu_trainer_gs
    trainer.init()
  File "/home/optml/holdenl/mwu/tf_utils.py", line 343, in init
    addon.init(self)
  File "/home/optml/holdenl/mwu/tf_utils.py", line 205, in init
    apply_gradient_op = opt.apply_gradients(grads, global_step = trainer.data['global_step']) if 'global_step' in trainer.data else opt.apply_gradients(grads)
TypeError: apply_gradients() got an unexpected keyword argument 'global_step'
Error in sys.excepthook:
Traceback (most recent call last):
  File "/usr/lib/python3/dist-packages/apport_python_hook.py", line 63, in apport_excepthook
    from apport.fileutils import likely_packaged, get_recent_crashes
  File "/usr/lib/python3/dist-packages/apport/__init__.py", line 5, in <module>
    from apport.report import Report
  File "/usr/lib/python3/dist-packages/apport/report.py", line 30, in <module>
    import apport.fileutils
  File "/usr/lib/python3/dist-packages/apport/fileutils.py", line 23, in <module>
    from apport.packaging_impl import impl as packaging
  File "/usr/lib/python3/dist-packages/apport/packaging_impl.py", line 23, in <module>
    import apt
  File "/usr/lib/python3/dist-packages/apt/__init__.py", line 23, in <module>
    import apt_pkg
ModuleNotFoundError: No module named 'apt_pkg'

Original exception was:
Traceback (most recent call last):
  File "mwu.py", line 378, in <module>
    ans = mnist_conv_test_gs(20,20,1, 3000,smoothing=0)
  File "mwu.py", line 346, in mnist_conv_test_gs
    return make_mwu_trainer_gs(model, ph_dict, Ws, bs, train_data, test_data, lr=lr,max_steps=max_steps, smoothing=smoothing)
  File "mwu.py", line 306, in make_mwu_trainer_gs
    trainer.init()
  File "/home/optml/holdenl/mwu/tf_utils.py", line 343, in init
    addon.init(self)
  File "/home/optml/holdenl/mwu/tf_utils.py", line 205, in init
    apply_gradient_op = opt.apply_gradients(grads, global_step = trainer.data['global_step']) if 'global_step' in trainer.data else opt.apply_gradients(grads)
TypeError: apply_gradients() got an unexpected keyword argument 'global_step'
]0;optml@valiant: ~/holdenl/mwuoptml@valiant:~/holdenl/mwu$ python mwu.py 
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally
Using TensorFlow backend.
20 20 1
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.027  0.002  0.011  0.003  0.018  0.009  0.014  0.002  0.005  0.016]
[  4.460e-04   1.816e-04   1.335e-04   3.248e-05   2.899e-04   2.696e-04
   2.075e-04   2.043e-04   4.082e-04   1.124e-04]
[  2.937e-04   7.338e-04   3.474e-04   1.220e-04   1.905e-04   3.046e-05
   3.122e-04   1.608e-04   1.890e-04   6.761e-05]
[ 0.005  0.007  0.     0.003  0.004  0.001  0.003  0.001  0.001  0.005]
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties: 
name: TITAN X (Pascal)
major: 6 minor: 1 memoryClockRate (GHz) 1.531
pciBusID 0000:02:00.0
Total memory: 11.90GiB
Free memory: 11.75GiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x376b310
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 1 with properties: 
name: GeForce GTX 1080
major: 6 minor: 1 memoryClockRate (GHz) 1.7335
pciBusID 0000:01:00.0
Total memory: 7.92GiB
Free memory: 7.00GiB
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 0 and 1
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 1 and 0
I tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0 1 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y N 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 1:   N Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Traceback (most recent call last):
  File "mwu.py", line 384, in <module>
    ans = mnist_conv_test_gs(20,20,1, 3000,smoothing=0)
  File "mwu.py", line 352, in mnist_conv_test_gs
    return make_mwu_trainer_gs(model, ph_dict, Ws, bs, train_data, test_data, lr=lr,max_steps=max_steps, smoothing=smoothing)
  File "mwu.py", line 312, in make_mwu_trainer_gs
    trainer.init()
  File "/home/optml/holdenl/mwu/tf_utils.py", line 343, in init
    addon.init(self)
  File "/home/optml/holdenl/mwu/tf_utils.py", line 205, in init
    apply_gradient_op = opt.apply_gradients(grads, global_step = trainer.data['global_step']) if 'global_step' in trainer.data else opt.apply_gradients(grads)
TypeError: apply_gradients() got an unexpected keyword argument 'global_step'
Error in sys.excepthook:
Traceback (most recent call last):
  File "/usr/lib/python3/dist-packages/apport_python_hook.py", line 63, in apport_excepthook
    from apport.fileutils import likely_packaged, get_recent_crashes
  File "/usr/lib/python3/dist-packages/apport/__init__.py", line 5, in <module>
    from apport.report import Report
  File "/usr/lib/python3/dist-packages/apport/report.py", line 30, in <module>
    import apport.fileutils
  File "/usr/lib/python3/dist-packages/apport/fileutils.py", line 23, in <module>
    from apport.packaging_impl import impl as packaging
  File "/usr/lib/python3/dist-packages/apport/packaging_impl.py", line 23, in <module>
    import apt
  File "/usr/lib/python3/dist-packages/apt/__init__.py", line 23, in <module>
    import apt_pkg
ModuleNotFoundError: No module named 'apt_pkg'

Original exception was:
Traceback (most recent call last):
  File "mwu.py", line 384, in <module>
    ans = mnist_conv_test_gs(20,20,1, 3000,smoothing=0)
  File "mwu.py", line 352, in mnist_conv_test_gs
    return make_mwu_trainer_gs(model, ph_dict, Ws, bs, train_data, test_data, lr=lr,max_steps=max_steps, smoothing=smoothing)
  File "mwu.py", line 312, in make_mwu_trainer_gs
    trainer.init()
  File "/home/optml/holdenl/mwu/tf_utils.py", line 343, in init
    addon.init(self)
  File "/home/optml/holdenl/mwu/tf_utils.py", line 205, in init
    apply_gradient_op = opt.apply_gradients(grads, global_step = trainer.data['global_step']) if 'global_step' in trainer.data else opt.apply_gradients(grads)
TypeError: apply_gradients() got an unexpected keyword argument 'global_step'
]0;optml@valiant: ~/holdenl/mwuoptml@valiant:~/holdenl/mwu$ python mwu.py 
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally
Using TensorFlow backend.
20 20 1
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.001  0.015  0.005  0.005  0.007  0.005  0.006  0.005  0.01   0.001]
[  3.553e-05   2.152e-05   1.059e-04   2.432e-04   2.302e-04   1.581e-04
   2.024e-04   1.550e-04   5.910e-04   1.944e-04]
[  6.217e-05   1.487e-04   1.024e-03   2.117e-04   9.366e-04   2.146e-04
   7.607e-05   4.224e-04   2.611e-05   9.680e-06]
[  3.490e-03   5.169e-03   5.730e-03   1.217e-02   1.192e-02   2.880e-03
   2.355e-03   8.438e-04   2.723e-05   1.028e-02]
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties: 
name: TITAN X (Pascal)
major: 6 minor: 1 memoryClockRate (GHz) 1.531
pciBusID 0000:02:00.0
Total memory: 11.90GiB
Free memory: 11.75GiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x37eee60
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 1 with properties: 
name: GeForce GTX 1080
major: 6 minor: 1 memoryClockRate (GHz) 1.7335
pciBusID 0000:01:00.0
Total memory: 7.92GiB
Free memory: 7.00GiB
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 0 and 1
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 1 and 0
I tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0 1 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y N 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 1:   N Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Traceback (most recent call last):
  File "mwu.py", line 384, in <module>
    ans = mnist_conv_test_gs(20,20,1, 3000,smoothing=0)
  File "mwu.py", line 352, in mnist_conv_test_gs
    return make_mwu_trainer_gs(model, ph_dict, Ws, bs, train_data, test_data, lr=lr,max_steps=max_steps, smoothing=smoothing)
  File "mwu.py", line 312, in make_mwu_trainer_gs
    trainer.init()
  File "/home/optml/holdenl/mwu/tf_utils.py", line 343, in init
    addon.init(self)
  File "/home/optml/holdenl/mwu/tf_utils.py", line 205, in init
    apply_gradient_op = opt.apply_gradients(grads, global_step = trainer.data['global_step']) if 'global_step' in trainer.data else opt.apply_gradients(grads)
  File "mwu.py", line 52, in apply_gradients
    return make_mw_ops_with_biases(self.ws, self.bs, self.eta, gradients=gradients, smoothing=self.smoothing, global_step = global_step)
  File "mwu.py", line 70, in make_mw_ops_with_biases
    w1 = w*tf.exp(-eta*g)
  File "/home/optml/keras_tf/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py", line 883, in binary_op_wrapper
    y = ops.convert_to_tensor(y, dtype=x.dtype.base_dtype, name="y")
  File "/home/optml/keras_tf/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 651, in convert_to_tensor
    as_ref=False)
  File "/home/optml/keras_tf/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 716, in internal_convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/home/optml/keras_tf/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 589, in _TensorTensorConversionFunction
    % (dtype.name, t.dtype.name, str(t)))
ValueError: Tensor conversion requested dtype float64 for Tensor with dtype float32: 'Tensor("gradients/convolution_grad/Conv2DBackpropFilter:0", shape=(8, 8, 2, 64), dtype=float32)'
Error in sys.excepthook:
Traceback (most recent call last):
  File "/usr/lib/python3/dist-packages/apport_python_hook.py", line 63, in apport_excepthook
    from apport.fileutils import likely_packaged, get_recent_crashes
  File "/usr/lib/python3/dist-packages/apport/__init__.py", line 5, in <module>
    from apport.report import Report
  File "/usr/lib/python3/dist-packages/apport/report.py", line 30, in <module>
    import apport.fileutils
  File "/usr/lib/python3/dist-packages/apport/fileutils.py", line 23, in <module>
    from apport.packaging_impl import impl as packaging
  File "/usr/lib/python3/dist-packages/apport/packaging_impl.py", line 23, in <module>
    import apt
  File "/usr/lib/python3/dist-packages/apt/__init__.py", line 23, in <module>
    import apt_pkg
ModuleNotFoundError: No module named 'apt_pkg'

Original exception was:
Traceback (most recent call last):
  File "mwu.py", line 384, in <module>
    ans = mnist_conv_test_gs(20,20,1, 3000,smoothing=0)
  File "mwu.py", line 352, in mnist_conv_test_gs
    return make_mwu_trainer_gs(model, ph_dict, Ws, bs, train_data, test_data, lr=lr,max_steps=max_steps, smoothing=smoothing)
  File "mwu.py", line 312, in make_mwu_trainer_gs
    trainer.init()
  File "/home/optml/holdenl/mwu/tf_utils.py", line 343, in init
    addon.init(self)
  File "/home/optml/holdenl/mwu/tf_utils.py", line 205, in init
    apply_gradient_op = opt.apply_gradients(grads, global_step = trainer.data['global_step']) if 'global_step' in trainer.data else opt.apply_gradients(grads)
  File "mwu.py", line 52, in apply_gradients
    return make_mw_ops_with_biases(self.ws, self.bs, self.eta, gradients=gradients, smoothing=self.smoothing, global_step = global_step)
  File "mwu.py", line 70, in make_mw_ops_with_biases
    w1 = w*tf.exp(-eta*g)
  File "/home/optml/keras_tf/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py", line 883, in binary_op_wrapper
    y = ops.convert_to_tensor(y, dtype=x.dtype.base_dtype, name="y")
  File "/home/optml/keras_tf/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 651, in convert_to_tensor
    as_ref=False)
  File "/home/optml/keras_tf/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 716, in internal_convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/home/optml/keras_tf/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 589, in _TensorTensorConversionFunction
    % (dtype.name, t.dtype.name, str(t)))
ValueError: Tensor conversion requested dtype float64 for Tensor with dtype float32: 'Tensor("gradients/convolution_grad/Conv2DBackpropFilter:0", shape=(8, 8, 2, 64), dtype=float32)'
]0;optml@valiant: ~/holdenl/mwuoptml@valiant:~/holdenl/mwu$ python mwu.py 
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally
Using TensorFlow backend.
20 20 1
^CTraceback (most recent call last):
  File "mwu.py", line 384, in <module>
    ans = mnist_conv_test_gs(20,20,1, 3000,smoothing=0)
  File "mwu.py", line 342, in mnist_conv_test_gs
    X_train, Y_train, X_test, Y_test = data_mnist()
  File "/home/optml/holdenl/cleverhans/cleverhans/utils_mnist.py", line 26, in data_mnist
    (X_train, y_train), (X_test, y_test) = mnist.load_data()
  File "/home/optml/keras_tf/lib/python3.6/site-packages/keras/datasets/mnist.py", line 17, in load_data
    x_train = f['x_train']
  File "/home/optml/keras_tf/lib/python3.6/site-packages/numpy/lib/npyio.py", line 233, in __getitem__
    pickle_kwargs=self.pickle_kwargs)
  File "/home/optml/keras_tf/lib/python3.6/site-packages/numpy/lib/format.py", line 625, in read_array
    shape, fortran_order, dtype = _read_array_header(fp, version)
  File "/home/optml/keras_tf/lib/python3.6/site-packages/numpy/lib/format.py", line 487, in _read_array_header
    header = _filter_header(header)
  File "/home/optml/keras_tf/lib/python3.6/site-packages/numpy/lib/format.py", line 450, in _filter_header
    for token in tokenize.generate_tokens(StringIO(asstr(s)).read):
  File "/home/optml/keras_tf/lib/python3.6/tokenize.py", line 599, in _tokenize
    pseudomatch = _compile(PseudoToken).match(line, pos)
  File "/home/optml/keras_tf/lib/python3.6/tokenize.py", line 153, in _compile
    return re.compile(expr, re.UNICODE)
  File "/home/optml/keras_tf/lib/python3.6/re.py", line 233, in compile
    return _compile(pattern, flags)
  File "/home/optml/keras_tf/lib/python3.6/re.py", line 301, in _compile
    p = sre_compile.compile(pattern, flags)
  File "/home/optml/keras_tf/lib/python3.6/sre_compile.py", line 562, in compile
    p = sre_parse.parse(p, flags)
  File "/home/optml/keras_tf/lib/python3.6/sre_parse.py", line 856, in parse
    p = _parse_sub(source, pattern, flags & SRE_FLAG_VERBOSE, False)
  File "/home/optml/keras_tf/lib/python3.6/sre_parse.py", line 415, in _parse_sub
    itemsappend(_parse(source, state, verbose))
  File "/home/optml/keras_tf/lib/python3.6/sre_parse.py", line 763, in _parse
    p = _parse_sub(source, state, sub_verbose)
  File "/home/optml/keras_tf/lib/python3.6/sre_parse.py", line 415, in _parse_sub
    itemsappend(_parse(source, state, verbose))
  File "/home/optml/keras_tf/lib/python3.6/sre_parse.py", line 763, in _parse
    p = _parse_sub(source, state, sub_verbose)
  File "/home/optml/keras_tf/lib/python3.6/sre_parse.py", line 415, in _parse_sub
    itemsappend(_parse(source, state, verbose))
  File "/home/optml/keras_tf/lib/python3.6/sre_parse.py", line 755, in _parse
    group = state.opengroup(name)
  File "/home/optml/keras_tf/lib/python3.6/sre_parse.py", line 87, in opengroup
    if self.groups > MAXGROUPS:
  File "/home/optml/keras_tf/lib/python3.6/sre_parse.py", line 83, in groups
    return len(self.groupwidths)
KeyboardInterrupt
]0;optml@valiant: ~/holdenl/mwuoptml@valiant:~/holdenl/mwu$ python mwu.py 
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally
Using TensorFlow backend.
20 20 1
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.005  0.011  0.001  0.016  0.004  0.017  0.007  0.006  0.006  0.006]
[  9.842e-06   6.542e-05   4.420e-07   2.915e-04   4.914e-04   3.376e-04
   9.272e-04   6.372e-04   1.911e-04   6.216e-05]
[  9.319e-05   5.648e-04   1.167e-06   7.482e-05   1.027e-04   1.021e-04
   8.707e-05   2.288e-04   1.895e-04   1.308e-04]
[ 0.003  0.     0.002  0.001  0.001  0.002  0.003  0.007  0.002  0.004]
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties: 
name: TITAN X (Pascal)
major: 6 minor: 1 memoryClockRate (GHz) 1.531
pciBusID 0000:02:00.0
Total memory: 11.90GiB
Free memory: 11.75GiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x3ab3940
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 1 with properties: 
name: GeForce GTX 1080
major: 6 minor: 1 memoryClockRate (GHz) 1.7335
pciBusID 0000:01:00.0
Total memory: 7.92GiB
Free memory: 7.00GiB
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 0 and 1
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 1 and 0
I tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0 1 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y N 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 1:   N Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Traceback (most recent call last):
  File "mwu.py", line 384, in <module>
    ans = mnist_conv_test_gs(20,20,1, 3000,smoothing=0)
  File "mwu.py", line 352, in mnist_conv_test_gs
    return make_mwu_trainer_gs(model, ph_dict, Ws, bs, train_data, test_data, lr=lr,max_steps=max_steps, smoothing=smoothing)
  File "mwu.py", line 312, in make_mwu_trainer_gs
    trainer.init()
  File "/home/optml/holdenl/mwu/tf_utils.py", line 343, in init
    addon.init(self)
  File "/home/optml/holdenl/mwu/tf_utils.py", line 205, in init
    apply_gradient_op = opt.apply_gradients(grads, global_step = trainer.data['global_step']) if 'global_step' in trainer.data else opt.apply_gradients(grads)
  File "mwu.py", line 52, in apply_gradients
    return make_mw_ops_with_biases(self.ws, self.bs, self.eta, gradients=gradients, smoothing=self.smoothing, global_step = global_step)
  File "mwu.py", line 70, in make_mw_ops_with_biases
    w1 = w*tf.exp(-eta*g)
  File "/home/optml/keras_tf/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py", line 883, in binary_op_wrapper
    y = ops.convert_to_tensor(y, dtype=x.dtype.base_dtype, name="y")
  File "/home/optml/keras_tf/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 651, in convert_to_tensor
    as_ref=False)
  File "/home/optml/keras_tf/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 716, in internal_convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/home/optml/keras_tf/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 589, in _TensorTensorConversionFunction
    % (dtype.name, t.dtype.name, str(t)))
ValueError: Tensor conversion requested dtype float64 for Tensor with dtype float32: 'Tensor("gradients/convolution_grad/Conv2DBackpropFilter:0", shape=(8, 8, 2, 64), dtype=float32)'
Error in sys.excepthook:
Traceback (most recent call last):
  File "/usr/lib/python3/dist-packages/apport_python_hook.py", line 63, in apport_excepthook
    from apport.fileutils import likely_packaged, get_recent_crashes
  File "/usr/lib/python3/dist-packages/apport/__init__.py", line 5, in <module>
    from apport.report import Report
  File "/usr/lib/python3/dist-packages/apport/report.py", line 30, in <module>
    import apport.fileutils
  File "/usr/lib/python3/dist-packages/apport/fileutils.py", line 23, in <module>
    from apport.packaging_impl import impl as packaging
  File "/usr/lib/python3/dist-packages/apport/packaging_impl.py", line 23, in <module>
    import apt
  File "/usr/lib/python3/dist-packages/apt/__init__.py", line 23, in <module>
    import apt_pkg
ModuleNotFoundError: No module named 'apt_pkg'

Original exception was:
Traceback (most recent call last):
  File "mwu.py", line 384, in <module>
    ans = mnist_conv_test_gs(20,20,1, 3000,smoothing=0)
  File "mwu.py", line 352, in mnist_conv_test_gs
    return make_mwu_trainer_gs(model, ph_dict, Ws, bs, train_data, test_data, lr=lr,max_steps=max_steps, smoothing=smoothing)
  File "mwu.py", line 312, in make_mwu_trainer_gs
    trainer.init()
  File "/home/optml/holdenl/mwu/tf_utils.py", line 343, in init
    addon.init(self)
  File "/home/optml/holdenl/mwu/tf_utils.py", line 205, in init
    apply_gradient_op = opt.apply_gradients(grads, global_step = trainer.data['global_step']) if 'global_step' in trainer.data else opt.apply_gradients(grads)
  File "mwu.py", line 52, in apply_gradients
    return make_mw_ops_with_biases(self.ws, self.bs, self.eta, gradients=gradients, smoothing=self.smoothing, global_step = global_step)
  File "mwu.py", line 70, in make_mw_ops_with_biases
    w1 = w*tf.exp(-eta*g)
  File "/home/optml/keras_tf/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py", line 883, in binary_op_wrapper
    y = ops.convert_to_tensor(y, dtype=x.dtype.base_dtype, name="y")
  File "/home/optml/keras_tf/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 651, in convert_to_tensor
    as_ref=False)
  File "/home/optml/keras_tf/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 716, in internal_convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/home/optml/keras_tf/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 589, in _TensorTensorConversionFunction
    % (dtype.name, t.dtype.name, str(t)))
ValueError: Tensor conversion requested dtype float64 for Tensor with dtype float32: 'Tensor("gradients/convolution_grad/Conv2DBackpropFilter:0", shape=(8, 8, 2, 64), dtype=float32)'
]0;optml@valiant: ~/holdenl/mwuoptml@valiant:~/holdenl/mwu$ python mwu.py rintf "\033c"ython mwu.py 
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally
Using TensorFlow backend.
20 20 1
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.     0.002  0.     0.002  0.015  0.005  0.006  0.016  0.008  0.018]
[  1.198e-04   7.704e-05   5.925e-04   4.405e-05   1.797e-05   1.988e-04
   1.010e-04   1.455e-04   9.397e-05   4.524e-05]
[  8.317e-05   1.462e-04   3.167e-05   2.172e-05   1.419e-04   6.348e-05
   3.427e-05   7.641e-05   8.788e-05   2.136e-05]
[ 0.001  0.003  0.002  0.002  0.009  0.004  0.     0.002  0.     0.007]
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties: 
name: TITAN X (Pascal)
major: 6 minor: 1 memoryClockRate (GHz) 1.531
pciBusID 0000:02:00.0
Total memory: 11.90GiB
Free memory: 11.75GiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x41dda20
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 1 with properties: 
name: GeForce GTX 1080
major: 6 minor: 1 memoryClockRate (GHz) 1.7335
pciBusID 0000:01:00.0
Total memory: 7.92GiB
Free memory: 7.00GiB
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 0 and 1
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 1 and 0
I tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0 1 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y N 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 1:   N Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.392944 seconds. Loss: 2.349447
Step 100 took 0.006660 seconds. Loss: 1.256192
Step 200 took 0.006686 seconds. Loss: 1.218212
Step 300 took 0.006417 seconds. Loss: 1.027512
Step 400 took 0.006952 seconds. Loss: 0.782676
Step 500 took 0.007164 seconds. Loss: 0.824806
Step 600 took 0.052278 seconds. Loss: 0.699629
Doing evaluation for test
accuracy: 0.824900
Step 700 took 0.006461 seconds. Loss: 0.678653
Step 800 took 0.006435 seconds. Loss: 0.666093
Step 900 took 0.007533 seconds. Loss: 0.770258
Step 1000 took 0.006819 seconds. Loss: 0.641850
Step 1100 took 0.006591 seconds. Loss: 0.546757
Step 1200 took 0.053256 seconds. Loss: 0.604521
Doing evaluation for test
accuracy: 0.844700
Step 1300 took 0.007089 seconds. Loss: 0.562819
Step 1400 took 0.006512 seconds. Loss: 0.665179
Step 1500 took 0.006843 seconds. Loss: 0.553753
Step 1600 took 0.006958 seconds. Loss: 0.569135
Step 1700 took 0.006630 seconds. Loss: 0.607634
Step 1800 took 0.066048 seconds. Loss: 0.679290
Doing evaluation for test
accuracy: 0.852500
Step 1900 took 0.007074 seconds. Loss: 0.455441
Step 2000 took 0.006434 seconds. Loss: 0.667151
Step 2100 took 0.006641 seconds. Loss: 0.522030
Step 2200 took 0.006605 seconds. Loss: 0.598139
Step 2300 took 0.006505 seconds. Loss: 0.729134
Step 2400 took 0.060101 seconds. Loss: 0.578482
Doing evaluation for test
accuracy: 0.858300
Step 2500 took 0.006995 seconds. Loss: 0.560514
Step 2600 took 0.007298 seconds. Loss: 0.644655
Step 2700 took 0.006681 seconds. Loss: 0.485036
Step 2800 took 0.006712 seconds. Loss: 0.650802
Step 2900 took 0.006674 seconds. Loss: 0.666400
Doing evaluation for test
accuracy: 0.862300
0.8622999972105027
]0;optml@valiant: ~/holdenl/mwuoptml@valiant:~/holdenl/mwu$ python mwu.py 
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally
Using TensorFlow backend.
20 20 1
X_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
[ 0.008  0.012  0.008  0.014  0.008  0.004  0.004  0.008  0.018  0.001]
[  1.865e-04   1.090e-06   3.389e-04   1.312e-04   2.994e-04   3.336e-05
   4.756e-06   1.989e-04   2.744e-04   6.122e-05]
[  9.796e-05   2.961e-04   1.807e-04   1.704e-04   2.530e-05   8.923e-05
   3.935e-05   1.112e-04   1.754e-05   2.143e-05]
[ 0.003  0.005  0.     0.001  0.002  0.018  0.     0.     0.     0.008]
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties: 
name: TITAN X (Pascal)
major: 6 minor: 1 memoryClockRate (GHz) 1.531
pciBusID 0000:02:00.0
Total memory: 11.90GiB
Free memory: 11.75GiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x5384d90
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 1 with properties: 
name: GeForce GTX 1080
major: 6 minor: 1 memoryClockRate (GHz) 1.7335
pciBusID 0000:01:00.0
Total memory: 7.92GiB
Free memory: 7.00GiB
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 0 and 1
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 1 and 0
I tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0 1 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y N 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 1:   N Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN X (Pascal), pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
Initializing variables.
Step 0 took 0.343723 seconds. Loss: 2.308662
Step 100 took 0.006891 seconds. Loss: 0.974965
Step 200 took 0.006712 seconds. Loss: 1.019996
Step 300 took 0.007004 seconds. Loss: 0.965682
Step 400 took 0.006483 seconds. Loss: 0.872782
Step 500 took 0.007443 seconds. Loss: 1.045885
Step 600 took 0.057857 seconds. Loss: 0.999070
Doing evaluation for test
accuracy: 0.828600
Step 700 took 0.007158 seconds. Loss: 1.064926
Step 800 took 0.006486 seconds. Loss: 1.261084
Step 900 took 0.006827 seconds. Loss: 1.362965
Step 1000 took 0.006510 seconds. Loss: 1.352930
Step 1100 took 0.006538 seconds. Loss: 1.428895
Step 1200 took 0.069235 seconds. Loss: 1.578744
Doing evaluation for test
accuracy: 0.764200
Step 1300 took 0.006948 seconds. Loss: 1.618792
Step 1400 took 0.006701 seconds. Loss: 1.675842
Step 1500 took 0.006364 seconds. Loss: 1.775056
Step 1600 took 0.006407 seconds. Loss: 1.864191
Step 1700 took 0.006732 seconds. Loss: 1.895433
Step 1800 took 0.065991 seconds. Loss: 1.978319
Doing evaluation for test
accuracy: 0.649800
Step 1900 took 0.006696 seconds. Loss: 2.026112
Step 2000 took 0.006496 seconds. Loss: 1.997140
Step 2100 took 0.006752 seconds. Loss: 2.105588
Step 2200 took 0.006486 seconds. Loss: 2.119117
Step 2300 took 0.006447 seconds. Loss: 2.153273
Step 2400 took 0.060542 seconds. Loss: 2.185056
Doing evaluation for test
accuracy: 0.529000
Step 2500 took 0.006536 seconds. Loss: 2.205332
Step 2600 took 0.006542 seconds. Loss: 2.219897
Step 2700 took 0.006579 seconds. Loss: 2.231346
Step 2800 took 0.006459 seconds. Loss: 2.253538
Step 2900 took 0.006905 seconds. Loss: 2.258640
Doing evaluation for test
accuracy: 0.493100
0.4930999839305878
]0;optml@valiant: ~/holdenl/mwuoptml@valiant:~/holdenl/mwu$ exit
exit

Script done on Sun 30 Apr 2017 04:13:34 PM EDT
